set cut_paste_input [stack 0]
version 12.2 v4
push $cut_paste_input
Group {
name Halation
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\n\nglow = nuke.thisNode()\['glow'].value()\nswitchYes = nuke.toNode('Switch2')\['which'].value()\n\nnum = nuke.toNode('Reformat1')\['sumBox'].value()\ninputWidth = nuke.toNode('Reformat1')\['inputWidth'].value()\ninputHeight = nuke.toNode('Reformat1')\['inputHeight'].value()\n\ndef isPrime(n) :\n    if (n <= 1) :\n        return False\n    if (n <= 3) :\n        return True\n    if (n % 2 == 0 or n % 3 == 0) :\n        return False\n    i = 5\n    while(i * i <= n) :\n        if (n % i == 0 or n % (i + 2) == 0) :\n            return False\n        i = i + 6\n        return True\n\nif (isPrime(num)) :\n    nuke.toNode('Reformat1').knob('box_width').setValue(inputWidth)\n    nuke.toNode('Reformat1').knob('box_height').setValue(inputHeight + 1)\nelse:\n     nuke.toNode('Reformat1').knob('box_width').setValue(inputWidth)\n     nuke.toNode('Reformat1').knob('box_height').setValue(inputHeight)\n\nif glow == 0:\n    n\[\"glow_intensity\"].setEnabled(False)\n    n\[\"glow_radius\"].setEnabled(False)\n    n\[\"glow_falloff\"].setEnabled(False)\n    n\[\"_1\"].setEnabled(False)\n    n\[\"_7\"].setEnabled(False)\n    n\[\"_8\"].setEnabled(False)\n    n\[\"_9\"].setEnabled(False)\nelse:\n    n\[\"glow_intensity\"].setEnabled(True)\n    n\[\"glow_radius\"].setEnabled(True)\n    n\[\"glow_falloff\"].setEnabled(True)\n    n\[\"_1\"].setEnabled(True)\n    n\[\"_7\"].setEnabled(True)\n    n\[\"_8\"].setEnabled(True)\n    n\[\"_9\"].setEnabled(True)\n\nif switchYes == 2:\n    n\[\"Erode\"].setEnabled(False)\n    n\[\"text_8\"].setEnabled(False)\n    n\[\"soft\"].setEnabled(False)\n    n\[\"_2\"].setEnabled(False)\n    n\[\"greens\"].setEnabled(True)\n    \nelse:\n    n\[\"Erode\"].setEnabled(True)\n    n\[\"text_8\"].setEnabled(True)\n    n\[\"soft\"].setEnabled(True)\n    n\[\"_2\"].setEnabled(True)\n    n\[\"greens\"].setEnabled(False)"
tile_color 0xff2323ff
selected true
xpos 12395
ypos -6531
addUserKnob {20 User l Controls}
addUserKnob {26 Name_and_Credit l "" +STARTLINE T "<font color=#ddd680 size=\"5\">H</font><font color=#ded990 size=\"5\">a</font><font color=#dfdba0 size=\"5\">l</font><font color=#e0ddb0 size=\"5\">a</font><font color=#e1dfc0 size=\"5\">t</font><font color=#e0ddb0 size=\"5\">i</font><font color=#dfdba0 size=\"5\">on</font><font color=#ded990 size=\"3\"> v</font><font color=#ded990 size=\"2\">2.8</font>\n<font color=#ded990 size=\"2\">| by silly calvin</font>"}
addUserKnob {26 ""}
addUserKnob {26 text_2 l "" +STARTLINE T "Halation type:   "}
addUserKnob {22 convolution_method l "<font color=#ded990 size=\"3\">Convolution method</font>" t "Respects values a lot more and it's recommended for a linear workspace with high dynamic footage. I tried tackling the issue in the past of the larger looking halation around stronger light sources and with the Convolution method, it solves this automatically but only if the footage has enough information. So 8-bit footage is unfortunately very bad at this.\n\nThis method comes with a reasonable price though which is the rendering speed and at times is really slow compared to the other ones. \n\n<b>IMPORTANT:</b> Another note though is that unfortunately, this method comes with a few bugs that I have not yet managed to fully fix and seems to be beyond my realm as of now.\n\nOne of them is that depending on the resolution of said footage if the sum of it is a prime number it may sometimes not like it and will introduce severe artifacts that I've semi-fixed as of now by adding a function that checks if it is either a prime number or not and if it is, it adds 1 number to the res and then reformats it back.\n\nAnother bug to keep in mind is that if the footage has too much information i.e values that go over around 50.0 it will introduce severe artifacts but it rarely happens, though can happen if the intensity of the halation is set to 1 or higher. Usually, this means that setting it down to 0 is enough for it since the values are so high. (remember the convolution method does not go by an alpha but rather the values)\n\n<b>Pros:</b>\nRespects the values in a physically correct\nmanner\n\nWorks in ACES\n\nThe most accurate of the 3 methods but at a\ncost of speed in terms of rendering\n\n<b>Cons:</b>\nSlow\n\nNot as much flexibility as the other 2 methods because it's not driven by an alpha but rather values for the benefit of accuracy" -STARTLINE T "nuke.toNode('Switch2').knob('which').setValue(2)\n\nnuke.thisNode().knob('convolution_method').setLabel('<font color=#ded990 size=\"3\">Convolution method</font>')\n\nnuke.thisNode().knob('screen_method').setLabel('Screen method')\n\nnuke.thisNode().knob('alpha_method').setLabel('Alpha method')\n\nnuke.thisNode().knob('blur_method').setEnabled(True)\nnuke.thisNode().knob('erode_method').setEnabled(False)\nnuke.thisNode().knob('both').setEnabled(False)\n\nnuke.thisNode().knob('blur_method').setLabel('<font color=#ded990 size=\"3\">Blur method</font>')\n\nnuke.thisNode().knob('erode_method').setLabel('Erode method')\nnuke.thisNode().knob('both').setLabel('Both')\n"}
addUserKnob {22 alpha_method l "Alpha method" t "Operatas a bit more smarter than screen method and even though screen method does as well technically use an alpha, I think the name fits since it tries not to touch the highlights as much as screen method does.\n\n<b>Pros:</b>\n Fast\n\n Driven by an alpha for flexibity but with a\n cost of accuracy\n\n<b>Cons:</b>\n Doesn't work with ACES\n\n Doesn't respect a linear workspace/ i.e the \n values in a phyically correct way" -STARTLINE T "nuke.toNode('Switch2').knob('which').setValue(1)\n\nnuke.thisNode().knob('alpha_method').setLabel('<font color=#ded990 size=\"3\">Alpha method</font>')\n\nnuke.thisNode().knob('screen_method').setLabel('Screen method')\nnuke.thisNode().knob('convolution_method').setLabel('Convolution method')\n\nnuke.thisNode().knob('blur_method').setEnabled(True)\nnuke.thisNode().knob('erode_method').setEnabled(True)\nnuke.thisNode().knob('both').setEnabled(True)\n\nnuke.thisNode().knob('both').setLabel('Both')\n"}
addUserKnob {22 screen_method l "Screen method" t "Has a softer look than alpha method and uses a simple screen merge operation, affects the highlights a little bit which can sometimes be something useful. Screen method uses at all time the \"both\" method.\n\n<b>Pros:</b>\n Fast\n Driven by an alpha for flexibity but with a\n cost of accuracy\n\n Technically works with ACES but at the cost\n of not looking quite the same as the alpha\n method.\n\n<b>Cons:</b>\n Doesn't respect a linear workspace/ i.e the \n values in a phyically correct way." -STARTLINE T "nuke.toNode('Switch2').knob('which').setValue(0)\n\nnuke.thisNode().knob('screen_method').setLabel('<font color=#ded990 size=\"3\">Screen method</font>')\n\nnuke.thisNode().knob('alpha_method').setLabel('Alpha method')\nnuke.thisNode().knob('convolution_method').setLabel('Convolution method')\n\nnuke.thisNode().knob('blur_method').setEnabled(False)\nnuke.thisNode().knob('erode_method').setEnabled(False)\n\nnuke.thisNode().knob('blur_method').setLabel('Blur method')\n\nnuke.thisNode().knob('erode_method').setLabel('Erode method')\nnuke.thisNode().knob('both').setLabel('<font color=#ded990 size=\"3\">Both</font>')\n"}
addUserKnob {26 help_1 l "" +STARTLINE T " ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏"}
addUserKnob {22 button_2 l Help? -STARTLINE T "nuke.message(\"Hover over the methods to find out more about them.\")"}
addUserKnob {26 ""}
addUserKnob {20 Key n 1}
Key 0
addUserKnob {26 ""}
addUserKnob {6 alpha l "Alpha preview" t "As the name suggests if you toggle this you'll see a preview of what the alpha looks like which is where the halation will affect. It's controlled by the parameters below." +STARTLINE}
addUserKnob {41 range l Key T Keyer1.range}
addUserKnob {26 ""}
addUserKnob {41 size l Blur T Blur5.size}
addUserKnob {26 ""}
addUserKnob {41 threshold l "Edge threshold" T EdgeDetect2.threshold}
addUserKnob {41 size_1 l Blur T Blur1.size}
addUserKnob {22 python_button_8 l "Reset to default" t "Reset values to a default state" T "nuke.thisNode().knob('range').setValue((0.43, 0.6, 1 ,1))\nnuke.thisNode().knob('threshold').setValue(0.6)\n\nnuke.thisNode().knob('size').setValue(25)\nnuke.thisNode().knob('size_1').setValue(5)" +STARTLINE}
addUserKnob {41 gain l Intensity T ColorCorrect1.gain}
addUserKnob {41 contrast l Contrast T ColorCorrect1.contrast}
addUserKnob {22 python_button l "Reset to default" t "Reset values to a default state" T "nuke.toNode('ColorCorrect1').knob('gain').setValue(0.75)\nnuke.toNode('ColorCorrect1').knob('contrast').setValue(0.75)\n" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {20 "" n -1}
addUserKnob {20 Main n 1}
Main 0
addUserKnob {26 ""}
addUserKnob {20 convolution l Convolution n 1}
convolution 0
addUserKnob {26 ""}
addUserKnob {7 Saturation R 0 4}
Saturation 1
addUserKnob {22 kernel_1 l "<font color=#ded990 size=\"3\">Kernel 1</font>" T "nuke.toNode('Switch5').knob('which').setValue(0)\n\nnuke.thisNode().knob('kernel_1').setLabel('<font color=#ded990 size=\"3\">Kernel 1</font>')\n\nnuke.thisNode().knob('kernel_2').setLabel('Kernel 2')\n\nnuke.thisNode().knob('kernel_3').setLabel('Kernel 3')" +STARTLINE}
addUserKnob {22 kernel_2 l "Kernel 2" -STARTLINE T "nuke.toNode('Switch5').knob('which').setValue(1)\n\nnuke.thisNode().knob('kernel_2').setLabel('<font color=#ded990 size=\"3\">Kernel 2</font>')\n\nnuke.thisNode().knob('kernel_1').setLabel('Kernel 1')\n\nnuke.thisNode().knob('kernel_3').setLabel('Kernel 3')"}
addUserKnob {22 kernel_3 l "Kernel 3" -STARTLINE T "nuke.toNode('Switch5').knob('which').setValue(2)\n\nnuke.thisNode().knob('kernel_3').setLabel('<font color=#ded990 size=\"3\">Kernel 3</font>')\n\nnuke.thisNode().knob('kernel_2').setLabel('Kernel 2')\n\nnuke.thisNode().knob('kernel_1').setLabel('Kernel 1')"}
addUserKnob {6 bleeding l "Reduce bleeding" t "If needed attemps to reduce the halation bleeding that occurs when its around the edges of the footage." +STARTLINE}
addUserKnob {22 button l Help? T "nuke.message(\"The convolution halation is driven by the Blur controls\")\nnuke.message(\"The kernels are as of now 3 different mini methods for how the convolution renders the flare at high values.\")\nnuke.message(\"Fix artifacts is to try and fix the servere artifacts that happens when it doesn't like a certain res by scrubbing the slider until the problem seems to be gone.\")\nnuke.message(\"Reduce bleeding, if need to be. Attemps to fix the halation bleeding that occurs when its around the edges of the footage. Works better if the fix artifact is set to higher than 1.\")" +STARTLINE}
addUserKnob {20 "" n -1}
addUserKnob {26 ""}
addUserKnob {20 halation l Halation n 1}
halation 0
addUserKnob {26 ""}
addUserKnob {7 double l Intensity R 0 2}
double 1
addUserKnob {22 blur_method l "<font color=#ded990 size=\"3\">Blur method</font>" t "Uses the blur node for how the halation will spread." T "nuke.toNode('Switch1').knob('which').setValue(0)\n\nnuke.thisNode().knob('blur_method').setLabel('<font color=#ded990 size=\"3\">Blur method</font>')\n\nnuke.thisNode().knob('erode_method').setLabel('Erode method')\nnuke.thisNode().knob('both').setLabel('Both')" +STARTLINE}
addUserKnob {22 erode_method l "Erode method" t "A bit harsher than blur and will instead erode the halation outwards." -STARTLINE +DISABLED T "nuke.toNode('Switch1').knob('which').setValue(1)\n\nnuke.thisNode().knob('blur_method').setLabel('Blur method')\n\nnuke.thisNode().knob('erode_method').setLabel('<font color=#ded990 size=\"3\">Erode method</font>')\nnuke.thisNode().knob('both').setLabel('Both')"}
addUserKnob {22 both l Both t "As the name suggests it combines both the blur method and erode method." -STARTLINE +DISABLED T "nuke.toNode('Switch1').knob('which').setValue(2)\n\nnuke.thisNode().knob('blur_method').setLabel('Blur method')\n\nnuke.thisNode().knob('erode_method').setLabel('Erode method')\nnuke.thisNode().knob('both').setLabel('<font color=#ded990 size=\"3\">Both</font>')"}
addUserKnob {26 text_1 l <b>Blur}
addUserKnob {18 Blur l "" +STARTLINE R 0 100}
Blur {8 4 0}
addUserKnob {6 Blur_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
Blur_panelDropped true
addUserKnob {6 color_rgb_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
color_rgb_panelDropped true
addUserKnob {6 soft l Soft +DISABLED +STARTLINE}
soft true
addUserKnob {6 greens l Green2Yellow t "Make any green turn to a more yellowish tone" -STARTLINE}
addUserKnob {22 _3 l "Reset to default" t "Reset values to a default state" T "nuke.thisNode().knob('Blur').setValue((8, 4, 0))\nnuke.thisNode().knob('double').setValue(1)\n" +STARTLINE}
addUserKnob {26 text_8 l <b>Erode</b> +DISABLED}
addUserKnob {18 Erode l "" +STARTLINE +DISABLED R -100 0}
Erode {-1.8 -0.9 0}
addUserKnob {6 Erode_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
Erode_panelDropped true
addUserKnob {22 _2 l "Reset to default" t "Reset values to a default state" +DISABLED T "nuke.thisNode().knob('Erode').setValue((-1.8, -0.9, 0))\n" +STARTLINE}
addUserKnob {20 "" n -1}
addUserKnob {26 ""}
addUserKnob {20 Other t "A set of optiniol neat functions. \n\nNOTE: As of now the Flare function will only work with Alpha method enabled. The flare function is an attempt to automate a larger like halation blob on strong light sources. This is still a WIP so it's not perfect yet." n 1}
Other 0
addUserKnob {26 ""}
addUserKnob {26 Glow l "" t "You can click on the color panel on the right of the knobs to change color if desired." +STARTLINE T <b>Glow</b>}
addUserKnob {6 glow l Off/On +STARTLINE}
addUserKnob {6 color_rgba_panelDropped l "panel dropped state" +HIDDEN +STARTLINE}
color_rgba_panelDropped true
addUserKnob {26 _7 l <b>Intensity +DISABLED}
addUserKnob {18 glow_intensity l "" +STARTLINE +DISABLED R 0 10}
glow_intensity 2.7
addUserKnob {6 glow_intensity_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
glow_intensity_panelDropped true
addUserKnob {26 _8 l <b>Radius +DISABLED}
addUserKnob {18 glow_radius l "" +STARTLINE +DISABLED R 0 10000}
glow_radius 35
addUserKnob {6 glow_radius_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
glow_radius_panelDropped true
addUserKnob {26 _9 l <b>Falloff +DISABLED}
addUserKnob {18 glow_falloff l "" +STARTLINE +DISABLED R 0 10}
glow_falloff 1
addUserKnob {6 glow_falloff_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {22 _1 l "Reset to default" t "Reset values to a default state" +DISABLED T "nuke.thisNode().knob('glow_intensity').setValue(2.7)\n\nnuke.thisNode().knob('glow_radius').setValue(35)\n\nnuke.thisNode().knob('glow_falloff').setValue(1)\n" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {20 "" n -1}
addUserKnob {20 "" n -1}
addUserKnob {20 tab l F_ReGrain}
addUserKnob {6 grain l Off/On +STARTLINE}
addUserKnob {41 grainType l "Grain Type" T F_ReGrain1.grainType}
addUserKnob {41 presetStock l "Preset Stock" T F_ReGrain1.presetStock}
addUserKnob {41 amount l "Grain Amount" T F_ReGrain1.amount}
addUserKnob {41 size_6 l "Grain Size" T F_ReGrain1.size}
addUserKnob {41 output l Output T F_ReGrain1.output}
addUserKnob {41 analyse l Analyse T F_ReGrain1.analyse}
addUserKnob {20 AnalysisRegion l "Analysis Region" n 1}
AnalysisRegion 0
addUserKnob {41 regionBL l "Analysis Region BL" T F_ReGrain1.regionBL}
addUserKnob {41 regionTR l "Analysis Region TR" T F_ReGrain1.regionTR}
addUserKnob {41 frame l "Analysis Frame" T F_ReGrain1.frame}
addUserKnob {41 grainColourSpace l "Grain Colour Space" T F_ReGrain1.grainColourSpace}
addUserKnob {20 "" n -1}
addUserKnob {20 Advanced n 1}
Advanced 0
addUserKnob {41 processRed l "Process Red" T F_ReGrain1.processRed}
addUserKnob {41 redAmount l "Red Amount" T F_ReGrain1.redAmount}
addUserKnob {41 redSize l "Red Size" T F_ReGrain1.redSize}
addUserKnob {41 processGreen l "Process Green" T F_ReGrain1.processGreen}
addUserKnob {41 greenAmount l "Green Amount" T F_ReGrain1.greenAmount}
addUserKnob {41 greenSize l "Green Size" T F_ReGrain1.greenSize}
addUserKnob {41 processBlue l "Process Blue" T F_ReGrain1.processBlue}
addUserKnob {41 blueAmount l "Blue Amount" T F_ReGrain1.blueAmount}
addUserKnob {41 blueSize l "Blue Size" T F_ReGrain1.blueSize}
addUserKnob {20 "Grain Response" n 1}
"Grain Response" 0
addUserKnob {41 srcColourSpace l "Apply Grain In" T F_ReGrain1.srcColourSpace}
addUserKnob {41 lowGain l "Low Gain" T F_ReGrain1.lowGain}
addUserKnob {41 midGain l "Mid Gain" T F_ReGrain1.midGain}
addUserKnob {41 highGain l "High Gain" T F_ReGrain1.highGain}
addUserKnob {41 useResponse l "Use Sampled Response" T F_ReGrain1.useResponse}
addUserKnob {41 responseMix l "Sampled Response Mix" T F_ReGrain1.responseMix}
addUserKnob {41 sample l "Sample Grain Response" T F_ReGrain1.sample}
addUserKnob {41 reset l "Reset Grain Response" T F_ReGrain1.reset}
addUserKnob {41 drawResponse l "Draw Response" T F_ReGrain1.drawResponse}
addUserKnob {20 "" n -1}
addUserKnob {20 "" n -1}
addUserKnob {41 about l About T F_ReGrain1.about}
}
BackdropNode {
inputs 0
name BackdropNode1
tile_color 0x4aaa69ff
label Convolution
note_font "Verdana Bold"
note_font_size 30
xpos -1968
ypos 7
bdwidth 926
bdheight 806
}
BackdropNode {
inputs 0
name highlight
tile_color 0x8893b5ff
label "OCIO Look Transform \n-\n\n\nPreserve\nHighlight"
note_font "Verdana Bold"
note_font_size 12
xpos -135
ypos -212
bdwidth 150
bdheight 344
}
BackdropNode {
inputs 0
name keying
tile_color 0x545454ff
gl_color 0xf4151bff
label Alpha
note_font "Verdana Bold"
note_font_size 50
xpos -1411
ypos -403
bdwidth 1126
bdheight 354
}
BackdropNode {
inputs 0
name main
tile_color 0x884b00ff
label "Halation (screen method)"
note_font "Verdana Bold"
note_font_size 25
xpos 170
ypos 29
bdwidth 331
bdheight 287
}
BackdropNode {
inputs 0
name filter
tile_color 0x880000ff
label "Halation (alpha method)\n"
note_font "Verdana Bold"
note_font_size 25
xpos -860
ypos 178
bdwidth 362
bdheight 258
z_order 1
}
Input {
inputs 0
name InputMask
xpos -270
ypos 701
number 2
}
set N3fd06c00 [stack 0]
Input {
inputs 0
name Input
note_font_color 0xff
xpos -219
ypos -352
}
Dot {
name Dot39
xpos -185
ypos -278
}
set N3fd06400 [stack 0]
Shuffle {
alpha black
black black
white black
red2 black
green2 black
name Shuffle7
xpos -295
ypos -282
}
Dot {
name Dot9
xpos -351
ypos -278
}
set N3fd05c00 [stack 0]
OCIOLogConvert {
operation "lin to log"
name OCIOLogConvert10
xpos -508
ypos -281
}
Keyer {
operation "luminance key"
range {0.43 0.6 1 1}
name Keyer1
xpos -722
ypos -287
}
Shuffle {
red alpha
green alpha
blue alpha
name Shuffle6
xpos -863
ypos -281
}
OCIOLogConvert {
operation "log to lin"
name OCIOLogConvert11
xpos -1016
ypos -281
}
OCIOLogConvert {
operation "log to lin"
name OCIOLogConvert1
xpos -1126
ypos -281
}
Defocus {
channels rgba
defocus 18
name Defocus1
xpos -1245
ypos -281
}
OCIOLogConvert {
operation "lin to log"
name OCIOLogConvert2
xpos -1369
ypos -281
}
Blur {
channels rgb
size 25
name Blur5
xpos -1369
ypos -202
}
Shuffle {
red black
green black
blue black
name Shuffle10
xpos -1369
ypos -95
}
push $N3fd05c00
Dot {
name Dot45
xpos -351
ypos -240
}
set N3fcc3000 [stack 0]
Dot {
name Dot3
xpos -351
ypos -196
}
OCIOLogConvert {
operation "lin to log"
name OCIOLogConvert5
xpos -492
ypos -199
}
EdgeDetectWrapper {
channels {rgba.red rgba.green -rgba.blue rgba.alpha}
threshold 0.6
blursize 3
name EdgeDetect2
xpos -635
ypos -205
}
Shuffle {
red alpha
green alpha
blue alpha
name Shuffle11
xpos -732
ypos -199
}
OCIOLogConvert {
operation "log to lin"
name OCIOLogConvert7
xpos -850
ypos -199
}
Shuffle {
red black
green black
blue black
alpha blue
name Shuffle12
xpos -967
ypos -199
}
ColorCorrect {
channels alpha
contrast 1.3
gain 0.016
name ColorCorrect4
xpos -1092
ypos -205
}
Blur {
channels alpha
size 5
maskChannelInput -rgba.alpha
name Blur1
xpos -1092
ypos -129
}
push $N3fcc3000
Dot {
name Dot47
xpos -1164
ypos -240
}
Keymix {
inputs 3
name Keymix1
xpos -1198
ypos -101
}
ColorCorrect {
channels alpha
contrast 0.75
gamma 1.38
gain 0.75
name ColorCorrect1
xpos -984
ypos -101
}
Dot {
name Dot20
xpos -950
ypos -19
}
set N3fc3fc00 [stack 0]
Dot {
name Dot23
label "Alpha preview"
note_font_size 20
xpos -950
ypos 646
}
Input {
inputs 0
name Grain
xpos -235
ypos 476
number 1
}
push $N3fd06c00
Constant {
inputs 0
channels rgb
format "3908 2602 0 0 3908 2602 1 "
name Constant1
xpos -1599
ypos 245
}
set N3fc3f000 [stack 0]
push 0
Group {
inputs 0
name Group1
tile_color 0x2f66ff
xpos -1489
ypos 354
addUserKnob {20 User}
addUserKnob {26 Headline l "" +STARTLINE T "<font color=#80dddd size=\"7\">S</font><font color=#90dede size=\"7\">p</font><font color=#a0dfdf size=\"7\">o</font><font color=#b0e0e0 size=\"7\">t</font><font color=#c0e1e1 size=\"7\">F</font><font color=#b0e0e0 size=\"7\">l</font><font color=#a0dfdf size=\"7\">are</font><font color=#90dede size=\"3\">v</font><font color=#80dddd size=\"2\">1.0</font>"}
addUserKnob {26 HeadlineB l "" +STARTLINE T "<font color=#80dddd size=\"2\">by Mads Hagbarth Lund</font>"}
addUserKnob {26 devider001 l "<b><font color=#70EE70>General</font><b>"}
addUserKnob {12 Position}
Position {1954 1301}
addUserKnob {7 Gain}
Gain 0.205
addUserKnob {7 Gamma R 0 5}
Gamma 0.14
addUserKnob {7 Scale}
Scale 0.315
addUserKnob {6 SoftClip t "By default, spotflare will be very bright at the center. Use softclip to limit the maximum brightness." +STARTLINE}
addUserKnob {7 softclipmax l max -STARTLINE R 1 100}
softclipmax 100
addUserKnob {6 glow_enable l Glow +STARTLINE}
glow_enable true
addUserKnob {6 EffectOnly l "Effect Only" +STARTLINE}
EffectOnly true
addUserKnob {22 FixJitter l "Fix Jitter" t "This does nothing... yet still fixes the bug with the expression node not updating its cashe from time to time.\nPlease fix The Foundry!" +STARTLINE}
addUserKnob {26 devider02 l "<b><font color=#70EE70>Color</font><b>"}
addUserKnob {18 GainTint}
GainTint {0.647098 0.305 0.135}
addUserKnob {6 GainTint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
GainTint_panelDropped true
addUserKnob {18 GammaTint}
GammaTint {1 0.84 0.17}
addUserKnob {6 GammaTint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
GammaTint_panelDropped true
addUserKnob {26 devide01 l "" +STARTLINE T " "}
addUserKnob {22 Reset l "Reset Color" T "nuke.thisNode().knob(\"GainTint\").setValue(1,0)\nnuke.thisNode().knob(\"GainTint\").setValue(1,1)\nnuke.thisNode().knob(\"GainTint\").setValue(1,2)\nnuke.thisNode().knob(\"GainTint\").setValue(1,3)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,0)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,1)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,2)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,3)" +STARTLINE}
addUserKnob {26 DeviderShimmer l "<b><font color=#70EE70>Shimmer</font><b>"}
addUserKnob {6 shimmer_enable l Shimmer +STARTLINE}
shimmer_enable true
addUserKnob {7 lacunarity l Detail R 0 5}
lacunarity 5
addUserKnob {7 noise_gain l Gain}
noise_gain 1
addUserKnob {7 Speed}
Speed 0.635
addUserKnob {7 Noise_Gang l "Time Offset" R 0 1000}
Noise_Gang 240
addUserKnob {26 devider04 l "<b><font color=#70EE70>Masking</font><b>"}
addUserKnob {6 Mask +STARTLINE}
addUserKnob {7 MaskRotation l "Mask Rotation"}
MaskRotation 0.31
addUserKnob {7 MaskGain l "Mask Gain"}
MaskGain 0.4
addUserKnob {7 MaskSoftness R 0 10}
MaskSoftness 2.35
}
BackdropNode {
inputs 0
name BackdropNode1
tile_color 0x7171c600
label Spike
note_font_size 42
xpos -222
ypos 207
bdwidth 270
bdheight 257
}
BackdropNode {
inputs 0
name BackdropNode2
tile_color 0x388e8e00
label Glow
note_font_size 42
xpos -597
ypos 209
bdwidth 280
bdheight 258
}
BackdropNode {
inputs 0
name BackdropNode3
tile_color 0x8e388e00
label Glare
note_font_size 42
xpos -1156
ypos 207
bdwidth 468
bdheight 298
}
BackdropNode {
inputs 0
name BackdropNode4
tile_color 0xffffffff
gl_color 0xff
label "WELCOME TO SPOTFLARE"
note_font_size 42
xpos -904
ypos -206
bdwidth 523
bdheight 138
}
BackdropNode {
inputs 0
name BackdropNode5
tile_color 0x71c67100
label "Spot Facing"
note_font_size 42
xpos -1463
ypos 208
bdwidth 252
bdheight 258
}
BackdropNode {
inputs 0
name BackdropNode6
tile_color 0xff
label "PLEASE ENJOY"
note_font_size 42
xpos -801
ypos 896
bdwidth 333
bdheight 160
}
StickyNote {
inputs 0
name StickyNote2
label "This is a super inefficient way\nto avoid the 1-0 seam and\na major performence hit.\nIf anyone have a better solution,\nplease mail me! =)"
note_font_size 8
xpos -1045
ypos 350
}
StickyNote {
inputs 0
name StickyNote1
tile_color 0xcc0000ff
gl_color 0xcc0000ff
label "not yet implamented"
xpos -222
ypos 206
}
Dot {
inputs 0
name Dot19
tile_color 0xff0000ff
xpos -674
ypos -127
hide_input true
}
Dot {
inputs 0
name Dot20
tile_color 0xffff00ff
xpos -658
ypos -127
hide_input true
}
Dot {
inputs 0
name Dot21
tile_color 0xff00ff
xpos -641
ypos -127
hide_input true
}
Dot {
inputs 0
name Dot22
tile_color 0xffffff
xpos -624
ypos -127
hide_input true
}
Dot {
inputs 0
name Dot23
tile_color 0xffff
xpos -607
ypos -127
hide_input true
}
Input {
inputs 0
name Input1
xpos -674
ypos -106
}
Dot {
name Dot13
xpos -640
ypos -25
}
set N3fc0b000 [stack 0]
Reformat {
format "3908 2602 0 0 3908 2602 1 "
black_outside true
name Reformat1
selected true
xpos -674
ypos 11
}
Shuffle {
red black
green black
blue black
alpha black
name Shuffle3
xpos -674
ypos 35
}
Dot {
name Dot1
xpos -640
ypos 131
}
set N3fc0a000 [stack 0]
Dot {
name Dot9
xpos -456
ypos 131
}
set N3fc09c00 [stack 0]
Dot {
name Dot2
xpos -61
ypos 131
}
Expression {
expr0 "(atan(x-parent.Position.x,-y--parent.Position.y)+ (pi))/(pi*2)"
name Expression8
xpos -95
ypos 268
}
Expression {
expr0 sin(r*(16*pi))
name Expression14
xpos -95
ypos 310
}
Grade {
white 0.89
gamma 0.2
name Grade6
xpos -95
ypos 352
}
Shuffle {
green red
blue red
alpha red
name Shuffle2
xpos -95
ypos 396
}
push $N3fc09c00
Expression {
temp_name0 xd
temp_expr0 parent.Position.x-x
temp_name1 yd
temp_expr1 parent.Position.y-y
temp_name2 dist
temp_expr2 "sqrt(xd*xd + yd*yd)"
temp_name3 scale
temp_expr3 "dist / ((parent.Scale*1))"
expr0 scale
channel1 {-rgba.red -rgba.green -rgba.blue none}
channel2 {-rgba.red -rgba.green -rgba.blue none}
channel3 {none none none -rgba.alpha}
enable_mix_luminance false
name distance
xpos -490
ypos 262
}
Grade {
white {{pow(1-parent.Gain,4)}}
gamma {{pow2(parent.Gamma)}}
name Grade16
xpos -490
ypos 305
}
Expression {
temp_name3 invsqr
temp_expr3 isnan(r)?0:1/(r*r)
expr0 invsqr
expr1 invsqr
expr2 invsqr
name Inverse_Square
xpos -490
ypos 341
}
Grade {
white {{parent.GainTint.r} {parent.GainTint.g} {parent.GainTint.b} 1}
white_panelDropped true
multiply {1 1 1 1}
multiply_panelDropped true
gamma {{parent.GammaTint} {parent.GammaTint} {parent.GammaTint} 1}
name Grade2
xpos -490
ypos 387
}
Clamp {
maximum 59999
MinClampTo_enable true
MaxClampTo {{maximum}}
MaxClampTo_enable true
name Clamp_Superbrights
xpos -490
ypos 428
}
set N3fbb3000 [stack 0]
Merge2 {
inputs 2
operation multiply
name Merge3
xpos -95
ypos 434
}
Dot {
name Dot3
xpos -61
ypos 708
}
Dot {
name Dot15
xpos -572
ypos 708
}
push $N3fc0a000
Dot {
name Dot16
xpos -750
ypos 131
}
set N3fbb2000 [stack 0]
Dot {
name Dot17
xpos -868
ypos 131
}
Dot {
name Dot7
xpos -1332
ypos 131
}
Expression {
temp_name0 theta
temp_expr0 pi*(parent.MaskRotation*2)
temp_name1 px
temp_expr1 "cos(theta) * (x-parent.Position.x) - sin(theta) * (y-parent.Position.y) + parent.Position.x"
temp_name2 py
temp_expr2 "sin(theta) * (x-parent.Position.x) + cos(theta) * (y-parent.Position.y) + parent.Position.y"
temp_name3 val
temp_expr3 "(atan(px-parent.Position.x,-py--parent.Position.y)+ pi)/+ (pi*2)"
expr0 "smoothstep(0,1, sin(val*pi))"
name Expression1
xpos -1366
ypos 298
}
Grade {
black 0.033
white {{(pow(parent.MaskGain,2)*10)+0.0001}}
gamma {{(pow(parent.MaskSoftness,2)/2)+0.15}}
name Grade9
xpos -1366
ypos 336
}
Expression {
expr0 max(0,1-r)
expr1 max(0,1-r)
expr2 max(0,1-r)
name Expression17
xpos -1366
ypos 380
}
Dot {
name Dot8
xpos -1332
ypos 745
}
push $N3fbb2000
Dot {
name Dot4
xpos -750
ypos 230
}
set N3fbb0400 [stack 0]
Dot {
name Dot5
xpos -868
ypos 230
}
Expression {
expr0 "(atan(x-parent.Position.x,-y--parent.Position.y)+ pi)/+ (pi*2)"
name inversefacing
xpos -902
ypos 267
}
set N3fb53800 [stack 0]
Dot {
name Dot18
xpos -978
ypos 270
}
Expression {
expr0 pow(sin(r*pi),16)
name reduction
xpos -1012
ypos 313
}
set N3fb53000 [stack 0]
Dot {
name Dot10
xpos -978
ypos 415
}
push $N3fb53000
push $N3fb53800
ShuffleCopy {
inputs 2
green red
alpha alpha2
name ShuffleCopy1
xpos -902
ypos 313
}
Expression {
temp_name0 octaves
temp_expr0 5
temp_name1 lacunarity
temp_expr1 parent.lacunarity
temp_name2 gain
temp_expr2 parent.noise_gain
temp_name3 Noise
temp_expr3 g>0.0001?fBm(r,1,1+((frame+parent.Noise_Gang)/((1.0001-parent.Speed)*10000)),octaves,lacunarity,gain):0
expr0 Noise
expr1 Noise
expr2 Noise
name noise_top
xpos -902
ypos 348
}
Grade {
black 0.54
gamma 0.585
black_clamp false
name Grade14
xpos -902
ypos 388
}
push $N3fbb0400
Expression {
temp_name0 xd
temp_expr0 parent.Position.x-x
temp_name1 yd
temp_expr1 parent.Position.y-y
temp_name2 dist
temp_expr2 "sqrt(xd*xd + yd*yd)"
expr0 "(atan(x-parent.Position.x,y-parent.Position.y)+ pi)/+ (pi*2)"
expr1 dist/width
name facing
xpos -784
ypos 267
}
Expression {
temp_name0 octaves
temp_expr0 5
temp_name1 lacunarity
temp_expr1 parent.lacunarity
temp_name2 gain
temp_expr2 parent.noise_gain
temp_name3 Noise
temp_expr3 fBm(r,1,1+((frame+8+parent.Noise_Gang)/((1.0001-parent.Speed)*10000)),octaves,lacunarity,gain)
expr0 Noise
expr1 Noise
expr2 Noise
name noise
xpos -784
ypos 314
}
Grade {
black 0.54
gamma 0.585
black_clamp false
name Grade15
xpos -784
ypos 412
}
Merge2 {
inputs 2+1
operation copy
maskChannelMask rgba.red
name FixSeam
xpos -902
ypos 412
}
push $N3fbb3000
Merge2 {
inputs 2
operation multiply
name Merge1
xpos -902
ypos 436
}
Clamp {
maximum_enable false
name Clamp_Negative_Numbers
xpos -902
ypos 460
}
Dot {
name Dot6
xpos -868
ypos 660
}
push $N3fbb3000
Dot {
name Dot11
xpos -456
ypos 587
}
push $N3fc0a000
Merge2 {
inputs 2
operation plus
name Merge6
xpos -674
ypos 584
disable {{1-parent.glow_enable}}
}
Merge2 {
inputs 2
operation plus
name Merge2
xpos -674
ypos 657
disable {{1-parent.shimmer_enable x2012 1}}
}
Merge2 {
inputs 2
operation multiply
name Merge5
xpos -674
ypos 742
disable {{1-parent.Mask}}
}
SoftClip {
conversion "preserve hue and saturation"
softclip_min 1
softclip_max {{parent.softclipmax}}
name SoftClip1
xpos -674
ypos 766
disable {{1-parent.SoftClip}}
}
push $N3fc0b000
Dot {
name Dot12
xpos -689
ypos -25
}
Grade {
multiply 0
black_clamp false
enable_mix_luminance false
name Grade1
xpos -723
ypos 77
disable {{1-parent.EffectOnly}}
}
Dot {
name Dot14
xpos -692
ypos 794
}
Merge2 {
inputs 2
operation plus
name Merge7
xpos -674
ypos 791
}
Output {
name Output1
xpos -674
ypos 991
}
end_group
push $N3fc3f000
Merge2 {
inputs 3+1
name Merge7
xpos -1599
ypos 354
}
Dot {
name Dot53
xpos -1565
ypos 398
}
set N3f935000 [stack 0]
Dot {
name Dot55
xpos -1821
ypos 398
}
Grade {
channels {rgba.red -rgba.green -rgba.blue none}
gamma 1.15
name Grade3
xpos -1855
ypos 513
}
Transform {
scale 0.11
center {1954 1301}
name Transform3
xpos -1764
ypos 513
}
Group {
name apGlow5
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -1764
ypos 576
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity 1
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 0.54
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.r}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 1
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
addUserKnob {14 overscan R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3f8dac00 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3f8da800 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3f8da800
Remove {
operation keep
channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
add_layer {apGlowArea apGlowArea.red}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N3f8d8400 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N3f893800 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N3f8d8400
push $N3f893800
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3f8dac00
Dot {
name Dot4
xpos -604
ypos 582
}
set N3f891000 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N3f891000
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Group {
name apGlow6
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -1855
ypos 576
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity 0.3
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 0.54
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.g}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 1
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
addUserKnob {14 overscan R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3f829800 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3f829400 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3f829400
Remove {
operation keep
channels {-rgba.red rgba.green -rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N3f7dac00 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N3f7da400 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N3f7dac00
push $N3f7da400
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3f829800
Dot {
name Dot4
xpos -604
ypos 582
}
set N3f76f800 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N3f76f800
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Group {
name apGlow13
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -1855
ypos 636
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity 0.16
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 0.54
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.r*1.5}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 9.7
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
addUserKnob {14 overscan R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3f76c400 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3f717c00 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3f717c00
Remove {
operation keep
channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N3f715800 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N3f715000 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N3f715800
push $N3f715000
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3f76c400
Dot {
name Dot4
xpos -604
ypos 582
}
set N3f6b6400 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N3f6b6400
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Grade {
channels {rgba.red -rgba.green -rgba.blue none}
gamma 1.56
name Grade7
xpos -1761
ypos 642
}
Dot {
name Dot58
xpos -1727
ypos 705
}
Dot {
name Dot63
xpos -1916
ypos 705
}
Dot {
name Dot64
xpos -1916
ypos 173
}
push $N3f935000
Dot {
name Dot54
xpos -1357
ypos 398
}
Grade {
channels {rgba.red -rgba.green -rgba.blue none}
gamma 1.05
name Grade6
xpos -1391
ypos 492
}
Transform {
scale 0.79
center {1954 1301}
name Transform5
xpos -1290
ypos 492
}
Grade {
channels {rgba.red rgba.green rgba.blue none}
whitepoint 1.08
gamma 0.62
name Grade5
xpos -1290
ypos 541
}
Transform {
scale 0.88
skewX 0.01
center {1954 1301}
name Transform6
xpos -1389
ypos 541
}
Group {
name apGlow9
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -1389
ypos 584
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity 1
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 10
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 4
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.r}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 1
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
addUserKnob {14 overscan R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3f664800 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3f664400 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3f664400
Remove {
operation keep
channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N3f605c00 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N3f605400 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N3f605c00
push $N3f605400
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3f664800
Dot {
name Dot4
xpos -604
ypos 582
}
set N3f55a800 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N3f55a800
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Group {
name apGlow10
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -1286
ypos 584
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity 0.19
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 10
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 4
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.g}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 4.9
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
addUserKnob {14 overscan R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3f4ef000 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3f4eec00 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3f4eec00
Remove {
operation keep
channels {-rgba.red rgba.green -rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N3f4ec800 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N3f4b3c00 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N3f4ec800
push $N3f4b3c00
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3f4ef000
Dot {
name Dot4
xpos -604
ypos 582
}
set N3f4b1400 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N3f4b1400
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Group {
name apGlow11
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -1286
ypos 645
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity 0.27
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 5.8
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.g*1.1}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 5.2
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
addUserKnob {14 overscan R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3f43dc00 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3f43d800 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3f43d800
Remove {
operation keep
channels {-rgba.red rgba.green -rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N3f3fb000 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N3f3fa800 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N3f3fb000
push $N3f3fa800
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3f43dc00
Dot {
name Dot4
xpos -604
ypos 582
}
set N3f38fc00 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N3f38fc00
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Group {
name apGlow12
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -1389
ypos 645
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity 10
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 0.54
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.r*1.5}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 3.45
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
addUserKnob {14 overscan R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3f38c800 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3f38c400 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3f38c400
Remove {
operation keep
channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N3f341c00 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N3f341400 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N3f341c00
push $N3f341400
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3f38c800
Dot {
name Dot4
xpos -604
ypos 582
}
set N3f2de800 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N3f2de800
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Dot {
name Dot56
xpos -1355
ypos 713
}
Group {
name apGlow7
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -1312
ypos 704
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity 1
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 10
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 4
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.b}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 2
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
addUserKnob {14 overscan R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3f276c00 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3f276800 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3f276800
Remove {
operation keep
channels {-rgba.red -rgba.green rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N3f274400 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N3f22f800 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N3f274400
push $N3f22f800
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3f276c00
Dot {
name Dot4
xpos -604
ypos 582
}
set N3f22d000 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N3f22d000
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Dot {
name Dot52
xpos -1162
ypos 713
}
Group {
name apGlow8
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -1196
ypos 646
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity 5.9
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 5.8
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.b*1.1}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 7.4
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
addUserKnob {14 overscan R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3f1d5400 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3f1d5000 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3f1d5000
Remove {
operation keep
channels {-rgba.red -rgba.green rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N3f166800 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N3f166000 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N3f166800
push $N3f166000
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3f1d5400
Dot {
name Dot4
xpos -604
ypos 582
}
set N3f0ff400 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N3f0ff400
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Dot {
name Dot59
xpos -1162
ypos 275
}
Dot {
name Dot60
xpos -1371
ypos 275
}
Group {
inputs 0
name Group3
tile_color 0x2f66ff
xpos -1517
ypos 522
addUserKnob {20 User}
addUserKnob {26 Headline l "" +STARTLINE T "<font color=#80dddd size=\"7\">S</font><font color=#90dede size=\"7\">p</font><font color=#a0dfdf size=\"7\">o</font><font color=#b0e0e0 size=\"7\">t</font><font color=#c0e1e1 size=\"7\">F</font><font color=#b0e0e0 size=\"7\">l</font><font color=#a0dfdf size=\"7\">are</font><font color=#90dede size=\"3\">v</font><font color=#80dddd size=\"2\">1.0</font>"}
addUserKnob {26 HeadlineB l "" +STARTLINE T "<font color=#80dddd size=\"2\">by Mads Hagbarth Lund</font>"}
addUserKnob {26 devider001 l "<b><font color=#70EE70>General</font><b>"}
addUserKnob {12 Position}
Position {1954 1301}
addUserKnob {7 Gain}
addUserKnob {7 Gamma R 0 5}
Gamma 0.9
addUserKnob {7 Scale}
Scale 0.01
addUserKnob {6 SoftClip t "By default, spotflare will be very bright at the center. Use softclip to limit the maximum brightness." +STARTLINE}
addUserKnob {7 softclipmax l max -STARTLINE R 1 100}
softclipmax 100
addUserKnob {6 glow_enable l Glow +STARTLINE}
glow_enable true
addUserKnob {6 EffectOnly l "Effect Only" +STARTLINE}
EffectOnly true
addUserKnob {22 FixJitter l "Fix Jitter" t "This does nothing... yet still fixes the bug with the expression node not updating its cashe from time to time.\nPlease fix The Foundry!" +STARTLINE}
addUserKnob {26 devider02 l "<b><font color=#70EE70>Color</font><b>"}
addUserKnob {18 GainTint}
GainTint {1 0.375 0}
addUserKnob {6 GainTint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
GainTint_panelDropped true
addUserKnob {18 GammaTint}
GammaTint {1 0.85 0}
addUserKnob {6 GammaTint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
GammaTint_panelDropped true
addUserKnob {26 devide01 l "" +STARTLINE T " "}
addUserKnob {22 Reset l "Reset Color" T "nuke.thisNode().knob(\"GainTint\").setValue(1,0)\nnuke.thisNode().knob(\"GainTint\").setValue(1,1)\nnuke.thisNode().knob(\"GainTint\").setValue(1,2)\nnuke.thisNode().knob(\"GainTint\").setValue(1,3)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,0)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,1)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,2)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,3)" +STARTLINE}
addUserKnob {26 DeviderShimmer l "<b><font color=#70EE70>Shimmer</font><b>"}
addUserKnob {6 shimmer_enable l Shimmer +STARTLINE}
shimmer_enable true
addUserKnob {7 lacunarity l Detail R 0 5}
lacunarity 4.5
addUserKnob {7 noise_gain l Gain}
noise_gain 7
addUserKnob {7 Speed}
Speed 0.635
addUserKnob {7 Noise_Gang l "Time Offset" R 0 1000}
Noise_Gang 240
addUserKnob {26 devider04 l "<b><font color=#70EE70>Masking</font><b>"}
addUserKnob {6 Mask +STARTLINE}
addUserKnob {7 MaskRotation l "Mask Rotation"}
MaskRotation 0.31
addUserKnob {7 MaskGain l "Mask Gain"}
MaskGain 0.4
addUserKnob {7 MaskSoftness R 0 10}
MaskSoftness 2.35
}
BackdropNode {
inputs 0
name BackdropNode1
tile_color 0x7171c600
label Spike
note_font_size 42
xpos -222
ypos 207
bdwidth 270
bdheight 257
}
BackdropNode {
inputs 0
name BackdropNode2
tile_color 0x388e8e00
label Glow
note_font_size 42
xpos -597
ypos 209
bdwidth 280
bdheight 258
}
BackdropNode {
inputs 0
name BackdropNode3
tile_color 0x8e388e00
label Glare
note_font_size 42
xpos -1156
ypos 207
bdwidth 468
bdheight 298
}
BackdropNode {
inputs 0
name BackdropNode4
tile_color 0xffffffff
gl_color 0xff
label "WELCOME TO SPOTFLARE"
note_font_size 42
xpos -904
ypos -206
bdwidth 523
bdheight 138
}
BackdropNode {
inputs 0
name BackdropNode5
tile_color 0x71c67100
label "Spot Facing"
note_font_size 42
xpos -1463
ypos 208
bdwidth 252
bdheight 258
}
BackdropNode {
inputs 0
name BackdropNode6
tile_color 0xff
label "PLEASE ENJOY"
note_font_size 42
xpos -801
ypos 896
bdwidth 333
bdheight 160
}
StickyNote {
inputs 0
name StickyNote2
label "This is a super inefficient way\nto avoid the 1-0 seam and\na major performence hit.\nIf anyone have a better solution,\nplease mail me! =)"
note_font_size 8
xpos -1045
ypos 350
}
StickyNote {
inputs 0
name StickyNote1
tile_color 0xcc0000ff
gl_color 0xcc0000ff
label "not yet implamented"
xpos -222
ypos 206
}
Dot {
inputs 0
name Dot19
tile_color 0xff0000ff
xpos -674
ypos -127
hide_input true
}
Dot {
inputs 0
name Dot20
tile_color 0xffff00ff
xpos -658
ypos -127
hide_input true
}
Dot {
inputs 0
name Dot21
tile_color 0xff00ff
xpos -641
ypos -127
hide_input true
}
Dot {
inputs 0
name Dot22
tile_color 0xffffff
xpos -624
ypos -127
hide_input true
}
Dot {
inputs 0
name Dot23
tile_color 0xffff
xpos -607
ypos -127
hide_input true
}
Input {
inputs 0
name Input1
xpos -674
ypos -106
}
Dot {
name Dot13
xpos -640
ypos -25
}
set N3f0a4c00 [stack 0]
Reformat {
format "3908 2602 0 0 3908 2602 1 "
black_outside true
name Reformat1
selected true
xpos -674
ypos 11
}
Shuffle {
red black
green black
blue black
alpha black
name Shuffle3
xpos -674
ypos 35
}
Dot {
name Dot1
xpos -640
ypos 131
}
set N3f07b800 [stack 0]
Dot {
name Dot9
xpos -456
ypos 131
}
set N3f07b400 [stack 0]
Dot {
name Dot2
xpos -61
ypos 131
}
Expression {
expr0 "(atan(x-parent.Position.x,-y--parent.Position.y)+ (pi))/(pi*2)"
name Expression8
xpos -95
ypos 268
}
Expression {
expr0 sin(r*(16*pi))
name Expression14
xpos -95
ypos 310
}
Grade {
white 0.89
gamma 0.2
name Grade6
xpos -95
ypos 352
}
Shuffle {
green red
blue red
alpha red
name Shuffle2
xpos -95
ypos 396
}
push $N3f07b400
Expression {
temp_name0 xd
temp_expr0 parent.Position.x-x
temp_name1 yd
temp_expr1 parent.Position.y-y
temp_name2 dist
temp_expr2 "sqrt(xd*xd + yd*yd)"
temp_name3 scale
temp_expr3 "dist / ((parent.Scale*1))"
expr0 scale
channel1 {-rgba.red -rgba.green -rgba.blue none}
channel2 {-rgba.red -rgba.green -rgba.blue none}
channel3 {none none none -rgba.alpha}
enable_mix_luminance false
name distance
xpos -490
ypos 262
}
Grade {
white {{pow(1-parent.Gain,4)}}
gamma {{pow2(parent.Gamma)}}
name Grade16
xpos -490
ypos 305
}
Expression {
temp_name3 invsqr
temp_expr3 isnan(r)?0:1/(r*r)
expr0 invsqr
expr1 invsqr
expr2 invsqr
name Inverse_Square
xpos -490
ypos 341
}
Grade {
white {{parent.GainTint.r} {parent.GainTint.g} {parent.GainTint.b} 1}
white_panelDropped true
multiply {1 1 1 1}
multiply_panelDropped true
gamma {{parent.GammaTint} {parent.GammaTint} {parent.GammaTint} 1}
name Grade2
xpos -490
ypos 387
}
Clamp {
maximum 59999
MinClampTo_enable true
MaxClampTo {{maximum}}
MaxClampTo_enable true
name Clamp_Superbrights
xpos -490
ypos 428
}
set N3f078c00 [stack 0]
Merge2 {
inputs 2
operation multiply
name Merge3
xpos -95
ypos 434
}
Dot {
name Dot3
xpos -61
ypos 708
}
Dot {
name Dot15
xpos -572
ypos 708
}
push $N3f07b800
Dot {
name Dot16
xpos -750
ypos 131
}
set N3f007800 [stack 0]
Dot {
name Dot17
xpos -868
ypos 131
}
Dot {
name Dot7
xpos -1332
ypos 131
}
Expression {
temp_name0 theta
temp_expr0 pi*(parent.MaskRotation*2)
temp_name1 px
temp_expr1 "cos(theta) * (x-parent.Position.x) - sin(theta) * (y-parent.Position.y) + parent.Position.x"
temp_name2 py
temp_expr2 "sin(theta) * (x-parent.Position.x) + cos(theta) * (y-parent.Position.y) + parent.Position.y"
temp_name3 val
temp_expr3 "(atan(px-parent.Position.x,-py--parent.Position.y)+ pi)/+ (pi*2)"
expr0 "smoothstep(0,1, sin(val*pi))"
name Expression1
xpos -1366
ypos 298
}
Grade {
black 0.033
white {{(pow(parent.MaskGain,2)*10)+0.0001}}
gamma {{(pow(parent.MaskSoftness,2)/2)+0.15}}
name Grade9
xpos -1366
ypos 336
}
Expression {
expr0 max(0,1-r)
expr1 max(0,1-r)
expr2 max(0,1-r)
name Expression17
xpos -1366
ypos 380
}
Dot {
name Dot8
xpos -1332
ypos 745
}
push $N3f007800
Dot {
name Dot4
xpos -750
ypos 230
}
set N3f005c00 [stack 0]
Dot {
name Dot5
xpos -868
ypos 230
}
Expression {
expr0 "(atan(x-parent.Position.x,-y--parent.Position.y)+ pi)/+ (pi*2)"
name inversefacing
xpos -902
ypos 267
}
set N3f005400 [stack 0]
Dot {
name Dot18
xpos -978
ypos 270
}
Expression {
expr0 pow(sin(r*pi),16)
name reduction
xpos -1012
ypos 313
}
set N3f004c00 [stack 0]
Dot {
name Dot10
xpos -978
ypos 415
}
push $N3f004c00
push $N3f005400
ShuffleCopy {
inputs 2
green red
alpha alpha2
name ShuffleCopy1
xpos -902
ypos 313
}
Expression {
temp_name0 octaves
temp_expr0 5
temp_name1 lacunarity
temp_expr1 parent.lacunarity
temp_name2 gain
temp_expr2 parent.noise_gain
temp_name3 Noise
temp_expr3 g>0.0001?fBm(r,1,1+((frame+parent.Noise_Gang)/((1.0001-parent.Speed)*10000)),octaves,lacunarity,gain):0
expr0 Noise
expr1 Noise
expr2 Noise
name noise_top
xpos -902
ypos 348
}
Grade {
black 0.54
gamma 0.585
black_clamp false
name Grade14
xpos -902
ypos 388
}
push $N3f005c00
Expression {
temp_name0 xd
temp_expr0 parent.Position.x-x
temp_name1 yd
temp_expr1 parent.Position.y-y
temp_name2 dist
temp_expr2 "sqrt(xd*xd + yd*yd)"
expr0 "(atan(x-parent.Position.x,y-parent.Position.y)+ pi)/+ (pi*2)"
expr1 dist/width
name facing
xpos -784
ypos 267
}
Expression {
temp_name0 octaves
temp_expr0 5
temp_name1 lacunarity
temp_expr1 parent.lacunarity
temp_name2 gain
temp_expr2 parent.noise_gain
temp_name3 Noise
temp_expr3 fBm(r,1,1+((frame+8+parent.Noise_Gang)/((1.0001-parent.Speed)*10000)),octaves,lacunarity,gain)
expr0 Noise
expr1 Noise
expr2 Noise
name noise
xpos -784
ypos 314
}
Grade {
black 0.54
gamma 0.585
black_clamp false
name Grade15
xpos -784
ypos 412
}
Merge2 {
inputs 2+1
operation copy
maskChannelMask rgba.red
name FixSeam
xpos -902
ypos 412
}
push $N3f078c00
Merge2 {
inputs 2
operation multiply
name Merge1
xpos -902
ypos 436
}
Clamp {
maximum_enable false
name Clamp_Negative_Numbers
xpos -902
ypos 460
}
Dot {
name Dot6
xpos -868
ypos 660
}
push $N3f078c00
Dot {
name Dot11
xpos -456
ypos 587
}
push $N3f07b800
Merge2 {
inputs 2
operation plus
name Merge6
xpos -674
ypos 584
disable {{1-parent.glow_enable}}
}
Merge2 {
inputs 2
operation plus
name Merge2
xpos -674
ypos 657
disable {{1-parent.shimmer_enable x2012 1}}
}
Merge2 {
inputs 2
operation multiply
name Merge5
xpos -674
ypos 742
disable {{1-parent.Mask}}
}
SoftClip {
conversion "preserve hue and saturation"
softclip_min 1
softclip_max {{parent.softclipmax}}
name SoftClip1
xpos -674
ypos 766
disable {{1-parent.SoftClip}}
}
push $N3f0a4c00
Dot {
name Dot12
xpos -689
ypos -25
}
Grade {
multiply 0
black_clamp false
enable_mix_luminance false
name Grade1
xpos -723
ypos 77
disable {{1-parent.EffectOnly}}
}
Dot {
name Dot14
xpos -692
ypos 794
}
Merge2 {
inputs 2
operation plus
name Merge7
xpos -674
ypos 791
}
Output {
name Output1
xpos -674
ypos 991
}
end_group
Constant {
inputs 0
channels rgb
format "3908 2602 0 0 3908 2602 1 "
name Constant3
xpos -1627
ypos 433
}
Merge2 {
inputs 2
name Merge8
xpos -1627
ypos 522
}
Clamp {
name Clamp4
xpos -1627
ypos 557
}
ColorCorrect {
gamma 0.79
shadows.gain 1.32
midtones.gamma 5
midtones.gain 0
name ColorCorrect11
xpos -1627
ypos 593
}
Transform {
scale 0.58
center {1954 1301}
name Transform4
xpos -1627
ypos 617
}
Group {
name apGlow15
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -1493
ypos 611
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity 10
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 0.54
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.r}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 1
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
addUserKnob {14 overscan R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3ef40800 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3ef40400 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3ef40400
Remove {
operation keep
channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N3eed9c00 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N3eed9400 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N3eed9c00
push $N3eed9400
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3ef40800
Dot {
name Dot4
xpos -604
ypos 582
}
set N3ee6e800 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N3ee6e800
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Group {
name apGlow17
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -1493
ypos 659
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity 10
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 0.54
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.r}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 1
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
addUserKnob {14 overscan R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3ee0f000 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3ee0ec00 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3ee0ec00
Remove {
operation keep
channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N3ee0c800 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N3edc7c00 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N3ee0c800
push $N3edc7c00
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3ee0f000
Dot {
name Dot4
xpos -604
ypos 582
}
set N3edc5400 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N3edc5400
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Group {
name apGlow16
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -1624
ypos 659
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity 10
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 0.54
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.g}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 1
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
addUserKnob {14 overscan R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3ed5dc00 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3ed5d800 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3ed5d800
Remove {
operation keep
channels {-rgba.red rgba.green -rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N3ed07000 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N3ed06800 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N3ed07000
push $N3ed06800
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3ed5dc00
Dot {
name Dot4
xpos -604
ypos 582
}
set N3eca3c00 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N3eca3c00
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Group {
name apGlow18
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -1624
ypos 706
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity 10
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 0.54
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.g}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 1
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
addUserKnob {14 overscan R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3eca0800 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3eca0400 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3eca0400
Remove {
operation keep
channels {-rgba.red rgba.green -rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N3ec59c00 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N3ec59400 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N3ec59c00
push $N3ec59400
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3eca0800
Dot {
name Dot4
xpos -604
ypos 582
}
set N3ebee800 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N3ebee800
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Group {
name apGlow19
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -1492
ypos 706
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity 10
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 0.54
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.b}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 1
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
addUserKnob {14 overscan R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3eb9b000 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3eb9ac00 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3eb9ac00
Remove {
operation keep
channels {-rgba.red -rgba.green rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N3eb98800 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N3eb4fc00 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N3eb98800
push $N3eb4fc00
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3eb9b000
Dot {
name Dot4
xpos -604
ypos 582
}
set N3eb4d400 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N3eb4d400
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Group {
name apGlow20
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -1492
ypos 771
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity 10
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 0.54
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.b}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 1
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
addUserKnob {14 overscan R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3eae9c00 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3eae9800 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3eae9800
Remove {
operation keep
channels {-rgba.red -rgba.green rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N3ea9b000 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N3ea9a800 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N3ea9b000
push $N3ea9a800
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3eae9c00
Dot {
name Dot4
xpos -604
ypos 582
}
set N3ea27c00 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N3ea27c00
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Dot {
name Dot62
xpos -1409
ypos 780
}
Dot {
name Dot57
xpos -1409
ypos 199
}
Switch {
inputs 3
name Switch5
xpos -1405
ypos 170
}
set N3ea25000 [stack 0]
push $N3fd06400
Shuffle {
alpha black
black black
white black
red2 black
green2 black
name Shuffle4
xpos -219
ypos -242
}
Reformat {
type "to box"
box_width 1920
box_height 1080
resize none
center false
name Reformat1
xpos -219
ypos -194
addUserKnob {20 User}
addUserKnob {7 sumBox}
sumBox {{input.height+input.width}}
addUserKnob {7 inputWidth}
inputWidth {{input.width}}
addUserKnob {7 inputHeight}
inputHeight {{input.height}}
}
Dot {
name Dot38
xpos -185
ypos -45
}
Dot {
name Dot37
xpos -1101
ypos -45
}
Transform {
scale 0.98
center {960 540}
name Transform1
xpos -1135
ypos 82
disable {{parent.bleeding==0}}
}
set N3e9eb400 [stack 0]
Group {
inputs 3
name LensKernelFFT1
tile_color 0xff7f28ff
xpos -1405
ypos 76
addUserKnob {20 User}
addUserKnob {4 output M {"convolution result" "input kernel" "" ""}}
addUserKnob {4 c l channels M {RGB RGBA ""}}
addUserKnob {4 kernel M {"35mm f1.4" "35mm f2.8" "35mm f5.6"}}
addUserKnob {3 pad l "pad frame" t "If bright areas of the convolved image 'wrap around' to the other side of the image, padding the frame will alleviate this problem. Also, if the bounding extends beyond the image, setting this to a larger size than 0 will allow you to reserve it. value is in pixels.\n"}
addUserKnob {7 mix}
mix 1
addUserKnob {20 Kernels}
addUserKnob {41 kernel14 l "35mm f1.4 kernel" T Read1.file}
addUserKnob {41 kernel28 l "35mm f2.8 kernel" T Read2.file}
addUserKnob {41 kernel56 l "35mm f5.6 kernel" T Read3.file}
}
Read {
inputs 0
file_type exr
format "3908 2602 0 0 3908 2602 1 "
origset true
in_colorspace scene_linear
out_colorspace scene_linear
name Read3
xpos -184
ypos -88
}
Read {
inputs 0
file_type exr
format "3908 2602 0 0 3908 2602 1 "
origset true
in_colorspace scene_linear
out_colorspace scene_linear
name Read2
xpos -387
ypos -128
}
Input {
inputs 0
name Input2
xpos -672
ypos 46
number 1
}
Switch {
inputs 3
which {{parent.kernel}}
name Switch1
xpos -382
ypos 91
}
Transform {
translate {1 0}
center {1954 1301}
name Transform
label recenter
xpos -382
ypos 122
disable true
}
Dot {
name Dot1
xpos -348
ypos 170
}
set N3e9e9400 [stack 0]
Dot {
name Dot2
xpos -238
ypos 170
}
Saturation {
saturation 0
name Saturation
label luminance
xpos -272
ypos 224
}
push $N3e9e9400
Copy {
inputs 2
from0 rgba.red
to0 rgba.alpha
name Copy
label luminance->alpha
xpos -382
ypos 218
}
Dot {
name Dot10
xpos -348
ypos 272
}
set N3e9e8400 [stack 0]
Dot {
name Dot9
xpos -458
ypos 272
}
Dot {
name Dot11
xpos -458
ypos 745
}
Input {
inputs 0
name Input1
xpos 0
ypos -11
}
NoOp {
name ImgIn
xpos 0
ypos 13
}
Dot {
name Dot12
xpos 34
ypos 59
}
set N3e986c00 [stack 0]
Reformat {
type "to box"
box_width {{"width + (2* parent.pad)"}}
box_height {{"height + (2* parent.pad)"}}
resize none
name Reformat_PadFrame
xpos 0
ypos 349
}
FFT {
channels rgba
name FFT2
xpos 0
ypos 395
}
Dot {
name Dot3
xpos 34
ypos 451
}
push $N3e9e8400
Reformat {
type "to box"
box_width {{LensKernelFFT1.Reformat_PadFrame.box_width.main}}
box_height {{LensKernelFFT1.Reformat_PadFrame.box_height.main}}
resize none
name ReformatKernel
xpos -382
ypos 350
}
FFT {
channels rgba
normalize_input true
center_kernel true
name FFT1
xpos -382
ypos 395
}
FFTMultiply {
inputs 2
name FFTMultiply1
xpos -382
ypos 442
}
set N3e984c00 [stack 0]
InvFFT {
name InvFFT1
xpos -382
ypos 478
}
Dot {
name Dot4
xpos -348
ypos 548
}
Dot {
name Dot6
xpos -138
ypos 548
}
set N3e953c00 [stack 0]
Dot {
name Dot7
xpos 15
ypos 548
}
push $N3e986c00
Dot {
name Dot13
xpos 170
ypos 59
}
Dot {
name Dot15
xpos 170
ypos 415
}
set N3e953000 [stack 0]
Dot {
name Dot5
xpos 34
ypos 501
}
set N3e952c00 [stack 0]
Copy {
inputs 2
channels rgba
name Copy3
xpos 0
ypos 581
}
Input {
inputs 0
name mask
selected true
xpos 210
ypos 587
number 2
}
push $N3e953c00
push $N3e952c00
Dot {
name Dot8
xpos -68
ypos 501
}
Copy {
inputs 2+1
channels rgb
mix 0.48
name Copy2
xpos -102
ypos 589
}
Switch {
inputs 2
which {{parent.c}}
name Switch2
xpos 0
ypos 668
}
Reformat {
type "to box"
box_width {{ImgIn.width}}
box_height {{ImgIn.height}}
resize none
name ReformatOutput
xpos 0
ypos 692
}
Switch {
inputs 2
which {{parent.output}}
name Switch3
xpos 0
ypos 742
}
push $N3e953000
Dot {
name Dot14
xpos 170
ypos 804
}
Dissolve {
inputs 2
channels rgba
which {{parent.mix}}
name Dissolve1
xpos 0
ypos 801
}
set N3e950400 [stack 0]
push $N3e984c00
Viewer {
inputs 2
frame_range 1-4473
name Viewer1
xpos -449
ypos 621
}
push $N3e950400
Output {
name Output1
xpos 0
ypos 871
}
Read {
inputs 0
file_type exr
format "3908 2602 0 0 3908 2602 1 "
origset true
in_colorspace scene_linear
out_colorspace scene_linear
name Read1
xpos -568
ypos -43
}
end_group
Dot {
name Dot68
xpos -1371
ypos 7
}
set N3e8ef000 [stack 0]
Dot {
name Dot66
xpos -1040
ypos 7
}
Dot {
name Dot65
xpos -1040
ypos 268
}
push 0
push $N3fd06c00
push $N3ea25000
push $N3e9eb400
Colorspace {
colorspace_in REDLog
name Colorspace2
xpos -1135
ypos 138
}
Group {
inputs 3
name LensKernelFFT3
tile_color 0xff7f28ff
xpos -1135
ypos 164
addUserKnob {20 User}
addUserKnob {4 output M {"convolution result" "input kernel" "" ""}}
addUserKnob {4 c l channels M {RGB RGBA ""}}
addUserKnob {4 kernel M {"35mm f1.4" "35mm f2.8" "35mm f5.6"}}
addUserKnob {3 pad l "pad frame" t "If bright areas of the convolved image 'wrap around' to the other side of the image, padding the frame will alleviate this problem. Also, if the bounding extends beyond the image, setting this to a larger size than 0 will allow you to reserve it. value is in pixels.\n"}
addUserKnob {7 mix}
mix 1
addUserKnob {20 Kernels}
addUserKnob {41 kernel14 l "35mm f1.4 kernel" T Read1.file}
addUserKnob {41 kernel28 l "35mm f2.8 kernel" T Read2.file}
addUserKnob {41 kernel56 l "35mm f5.6 kernel" T Read3.file}
}
Read {
inputs 0
file_type exr
format "3908 2602 0 0 3908 2602 1 "
origset true
in_colorspace scene_linear
out_colorspace scene_linear
name Read3
xpos -184
ypos -88
}
Read {
inputs 0
file_type exr
format "3908 2602 0 0 3908 2602 1 "
origset true
in_colorspace scene_linear
out_colorspace scene_linear
name Read2
xpos -387
ypos -128
}
Input {
inputs 0
name Input2
xpos -672
ypos 46
number 1
}
Switch {
inputs 3
which {{parent.kernel}}
name Switch1
xpos -382
ypos 91
}
Transform {
translate {1 0}
center {1954 1301}
name Transform
label recenter
xpos -382
ypos 122
disable true
}
Dot {
name Dot1
xpos -348
ypos 170
}
set N3e8ec400 [stack 0]
Dot {
name Dot2
xpos -238
ypos 170
}
Saturation {
saturation 0
name Saturation
label luminance
xpos -272
ypos 224
}
push $N3e8ec400
Copy {
inputs 2
from0 rgba.red
to0 rgba.alpha
name Copy
label luminance->alpha
xpos -382
ypos 218
}
Dot {
name Dot10
xpos -348
ypos 272
}
set N3e8a3000 [stack 0]
Dot {
name Dot9
xpos -458
ypos 272
}
Dot {
name Dot11
xpos -458
ypos 745
}
Input {
inputs 0
name Input1
xpos 0
ypos -11
}
NoOp {
name ImgIn
xpos 0
ypos 13
}
Dot {
name Dot12
xpos 34
ypos 59
}
set N3e8a1c00 [stack 0]
Reformat {
type "to box"
box_width {{"width + (2* parent.pad)"}}
box_height {{"height + (2* parent.pad)"}}
resize none
name Reformat_PadFrame
xpos 0
ypos 349
}
FFT {
channels rgba
name FFT2
xpos 0
ypos 395
}
Dot {
name Dot3
xpos 34
ypos 451
}
push $N3e8a3000
Reformat {
type "to box"
box_width {{LensKernelFFT3.Reformat_PadFrame.box_width.main}}
box_height {{LensKernelFFT3.Reformat_PadFrame.box_height.main}}
resize none
name ReformatKernel
xpos -382
ypos 350
}
FFT {
channels rgba
normalize_input true
center_kernel true
name FFT1
xpos -382
ypos 395
}
FFTMultiply {
inputs 2
name FFTMultiply1
xpos -382
ypos 442
}
set N3e86b800 [stack 0]
InvFFT {
name InvFFT1
xpos -382
ypos 478
}
Dot {
name Dot4
xpos -348
ypos 548
}
Dot {
name Dot6
xpos -138
ypos 548
}
set N3e86ac00 [stack 0]
Dot {
name Dot7
xpos 15
ypos 548
}
push $N3e8a1c00
Dot {
name Dot13
xpos 170
ypos 59
}
Dot {
name Dot15
xpos 170
ypos 415
}
set N3e86a000 [stack 0]
Dot {
name Dot5
xpos 34
ypos 501
}
set N3e869c00 [stack 0]
Copy {
inputs 2
channels rgba
name Copy3
xpos 0
ypos 581
}
Input {
inputs 0
name mask
selected true
xpos 314
ypos 600
number 2
}
push $N3e86ac00
push $N3e869c00
Dot {
name Dot8
xpos -68
ypos 501
}
Copy {
inputs 2+1
channels rgb
mix 0.48
name Copy2
xpos -102
ypos 588
}
Switch {
inputs 2
which {{parent.c}}
name Switch2
xpos 0
ypos 668
}
Reformat {
type "to box"
box_width {{ImgIn.width}}
box_height {{ImgIn.height}}
resize none
name ReformatOutput
xpos 0
ypos 692
}
Switch {
inputs 2
which {{parent.output}}
name Switch3
xpos 0
ypos 742
}
push $N3e86a000
Dot {
name Dot14
xpos 170
ypos 804
}
Dissolve {
inputs 2
channels rgba
which {{parent.mix}}
name Dissolve1
xpos 0
ypos 801
}
set N3e81f000 [stack 0]
push $N3e86b800
Viewer {
inputs 2
frame_range 1-4473
name Viewer1
xpos -449
ypos 621
}
push $N3e81f000
Output {
name Output1
xpos 0
ypos 871
}
Read {
inputs 0
file_type exr
format "3908 2602 0 0 3908 2602 1 "
origset true
in_colorspace scene_linear
out_colorspace scene_linear
name Read1
xpos -568
ypos -43
}
end_group
Colorspace {
colorspace_out REDLog
name Colorspace5
xpos -1135
ypos 202
}
push $N3fd06c00
push $N3ea25000
Dot {
name Dot70
xpos -1446
ypos 92
}
push $N3e8ef000
Dot {
name Dot69
xpos -1481
ypos 7
}
Colorspace {
colorspace_in REDLog
name Colorspace1
xpos -1514
ypos 43
}
Colorspace {
colorspace_in REDLog
name Colorspace6
xpos -1624
ypos 43
}
Group {
inputs 3
name LensKernelFFT2
tile_color 0xff7f28ff
xpos -1624
ypos 83
addUserKnob {20 User}
addUserKnob {4 output M {"convolution result" "input kernel" "" ""}}
addUserKnob {4 c l channels M {RGB RGBA ""}}
addUserKnob {4 kernel M {"35mm f1.4" "35mm f2.8" "35mm f5.6"}}
addUserKnob {3 pad l "pad frame" t "If bright areas of the convolved image 'wrap around' to the other side of the image, padding the frame will alleviate this problem. Also, if the bounding extends beyond the image, setting this to a larger size than 0 will allow you to reserve it. value is in pixels.\n"}
addUserKnob {7 mix}
mix 1
addUserKnob {20 Kernels}
addUserKnob {41 kernel14 l "35mm f1.4 kernel" T Read1.file}
addUserKnob {41 kernel28 l "35mm f2.8 kernel" T Read2.file}
addUserKnob {41 kernel56 l "35mm f5.6 kernel" T Read3.file}
}
Read {
inputs 0
file_type exr
format "3908 2602 0 0 3908 2602 1 "
origset true
in_colorspace scene_linear
out_colorspace scene_linear
name Read3
xpos -184
ypos -88
}
Read {
inputs 0
file_type exr
format "3908 2602 0 0 3908 2602 1 "
origset true
in_colorspace scene_linear
out_colorspace scene_linear
name Read2
xpos -387
ypos -128
}
Input {
inputs 0
name Input2
xpos -672
ypos 46
number 1
}
Switch {
inputs 3
which {{parent.kernel}}
name Switch1
xpos -382
ypos 91
}
Transform {
translate {1 0}
center {1954 1301}
name Transform
label recenter
xpos -382
ypos 122
disable true
}
Dot {
name Dot1
xpos -348
ypos 170
}
set N3e7b6c00 [stack 0]
Dot {
name Dot2
xpos -238
ypos 170
}
Saturation {
saturation 0
name Saturation
label luminance
xpos -272
ypos 224
}
push $N3e7b6c00
Copy {
inputs 2
from0 rgba.red
to0 rgba.alpha
name Copy
label luminance->alpha
xpos -382
ypos 218
}
Dot {
name Dot10
xpos -348
ypos 272
}
set N3e7b5c00 [stack 0]
Dot {
name Dot9
xpos -458
ypos 272
}
Dot {
name Dot11
xpos -458
ypos 745
}
Input {
inputs 0
name Input1
xpos 0
ypos -11
}
NoOp {
name ImgIn
xpos 0
ypos 13
}
Dot {
name Dot12
xpos 34
ypos 59
}
set N3e7b4800 [stack 0]
Reformat {
type "to box"
box_width {{"width + (2* parent.pad)"}}
box_height {{"height + (2* parent.pad)"}}
resize none
name Reformat_PadFrame
xpos 0
ypos 349
}
FFT {
channels rgba
name FFT2
xpos 0
ypos 395
}
Dot {
name Dot3
xpos 34
ypos 451
}
push $N3e7b5c00
Reformat {
type "to box"
box_width {{LensKernelFFT2.Reformat_PadFrame.box_width.main}}
box_height {{LensKernelFFT2.Reformat_PadFrame.box_height.main}}
resize none
name ReformatKernel
xpos -382
ypos 350
}
FFT {
channels rgba
normalize_input true
center_kernel true
name FFT1
xpos -382
ypos 395
}
FFTMultiply {
inputs 2
name FFTMultiply1
xpos -382
ypos 442
}
set N3e76e400 [stack 0]
InvFFT {
name InvFFT1
xpos -382
ypos 478
}
Dot {
name Dot4
xpos -348
ypos 548
}
Dot {
name Dot6
xpos -138
ypos 548
}
set N3e76d800 [stack 0]
Dot {
name Dot7
xpos 15
ypos 548
}
push $N3e7b4800
Dot {
name Dot13
xpos 170
ypos 59
}
Dot {
name Dot15
xpos 170
ypos 415
}
set N3e76cc00 [stack 0]
Dot {
name Dot5
xpos 34
ypos 501
}
set N3e76c800 [stack 0]
Copy {
inputs 2
channels rgba
name Copy3
xpos 0
ypos 581
}
Input {
inputs 0
name mask
selected true
xpos 364
ypos 597
number 2
}
push $N3e76d800
push $N3e76c800
Dot {
name Dot8
xpos -68
ypos 501
}
Copy {
inputs 2+1
channels rgb
mix 0.48
name Copy2
xpos -102
ypos 589
}
Switch {
inputs 2
which {{parent.c}}
name Switch2
xpos 0
ypos 668
}
Reformat {
type "to box"
box_width {{ImgIn.width}}
box_height {{ImgIn.height}}
resize none
name ReformatOutput
xpos 0
ypos 692
}
Switch {
inputs 2
which {{parent.output}}
name Switch3
xpos 0
ypos 742
}
push $N3e76cc00
Dot {
name Dot14
xpos 170
ypos 804
}
Dissolve {
inputs 2
channels rgba
which {{parent.mix}}
name Dissolve1
xpos 0
ypos 801
}
set N3e729c00 [stack 0]
push $N3e76e400
Viewer {
inputs 2
frame_range 1-4473
name Viewer1
xpos -449
ypos 621
}
push $N3e729c00
Output {
name Output1
xpos 0
ypos 871
}
Read {
inputs 0
file_type exr
format "3908 2602 0 0 3908 2602 1 "
origset true
in_colorspace scene_linear
out_colorspace scene_linear
name Read1
xpos -568
ypos -43
}
end_group
Colorspace {
colorspace_out REDLog
name Colorspace11
xpos -1624
ypos 144
}
Colorspace {
colorspace_out REDLog
name Colorspace12
xpos -1514
ypos 144
}
Dot {
name Dot71
xpos -1480
ypos 268
}
Dissolve {
inputs 3+1
which {{"2 - (parent.double)"}}
name Dissolve1
xpos -1135
ypos 259
}
Transform {
scale {{parent.Transform1.scale}}
center {960 540}
invert_matrix true
name Transform2
xpos -1135
ypos 322
disable {{parent.bleeding==0}}
}
Shuffle {
name Shuffle1
xpos -1135
ypos 363
}
Crop {
box {0 0 {Input.width} {Input.height}}
reformat true
crop false
name Crop1
xpos -1135
ypos 407
}
Dot {
name Dot40
xpos -1101
ypos 464
}
push $N3fd06400
Shuffle {
alpha black
black black
white black
red2 black
green2 black
name Shuffle5
xpos -158
ypos -281
}
Dot {
name Dot1
xpos -61
ypos -277
}
set N3e6ca400 [stack 0]
Dot {
name Dot34
xpos 71
ypos -277
}
set N3e6ca000 [stack 0]
Dot {
name Dot28
xpos 68
ypos 153
}
set N3e6c9c00 [stack 0]
Dot {
name Dot72
xpos -968
ypos 147
}
Merge2 {
inputs 2
operation minus
name Merge9
xpos -1002
ypos 460
}
Saturation {
saturation {{parent.Saturation}}
mode Maximum
name Saturation1
selected true
xpos -903
ypos 460
}
Clamp {
maximum_enable false
name Clamp1
xpos -903
ypos 508
}
Dot {
name Dot51
xpos -869
ypos 568
}
Expression {
temp_name0 first
temp_expr0 "\t (  (b>g) ? r*(wht.r-cyn.r) + g*(cyn.r-blu.r) + b*blu.r : ( (b>r) ? r*(wht.r-cyn.r) + g*grn.r + b*(cyn.r-grn.r) : r*(yel.r-grn.r) + g*grn.r + b*(wht.r-yel.r) ) )\n"
temp_name1 second
temp_expr1 "\t (  (b>g) ? r*(wht.g-cyn.g) + g*(cyn.g-blu.g) + b*blu.g : ( (b>r) ? r*(wht.g-cyn.g) + g*grn.g + b*(cyn.g-grn.g) : r*(yel.g-grn.g) + g*grn.g + b*(wht.g-yel.g) ) )\n"
temp_name2 third
temp_expr2 "\t (  (b>g) ? r*(wht.b-cyn.b) + g*(cyn.b-blu.b) + b*blu.b : ( (b>r) ? r*(wht.b-cyn.b) + g*grn.b + b*(cyn.b-grn.b) : r*(yel.b-grn.b) + g*grn.b + b*(wht.b-yel.b) ) )"
expr0 "\t(r>g) ? ( (g>b) ? r*red.r + g*(yel.r-red.r) + b*(wht.r-yel.r) : ( (r>b) ? r*red.r + g*(wht.r-mag.r) + b*(mag.r-red.r) : r*(mag.r-blu.r) + g*(wht.r-mag.r) + b*blu.r ) ) \n\t:\n\tfirst"
expr1 "\t(r>g) ? ( (g>b) ? r*red.g + g*(yel.g-red.g) + b*(wht.g-yel.g) : ( (r>b) ? r*red.g + g*(wht.g-mag.g) + b*(mag.g-red.g) : r*(mag.g-blu.g) + g*(wht.g-mag.g) + b*blu.g ) ) \n\t:\n\tsecond"
expr2 "\t(r>g) ? ( (g>b) ? r*red.b + g*(yel.b-red.b) + b*(wht.b-yel.b) : ( (r>b) ? r*red.b + g*(wht.b-mag.b) + b*(mag.b-red.b) : r*(mag.b-blu.b) + g*(wht.b-mag.b) + b*blu.b ) ) \n\t:\n\tthird"
name Expression1
xpos -789
ypos 564
disable {{parent.greens==0}}
addUserKnob {20 User}
addUserKnob {18 wht l 1}
wht {1 1 1}
addUserKnob {6 wht_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 color_rgb_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 red l 2}
red {1 0 0}
addUserKnob {6 red_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 color_rgb_1_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 grn l 3}
grn {1 1 0}
addUserKnob {6 grn_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 color_rgb_2_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 blu l 4}
blu {0 0 1}
addUserKnob {6 blu_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 color_rgb_3_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 cyn l 5}
cyn {1 1 1}
addUserKnob {6 cyn_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 color_rgb_4_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 mag l 6}
mag {1 0 1}
addUserKnob {6 mag_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 color_rgb_5_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 yel l 7}
yel {1 1 0}
addUserKnob {6 yel_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 color_rgb_6_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
}
Group {
name GamutCompress
xpos -789
ypos 530
disable {{"Saturation ? Saturation < 1.0001 : false"}}
addUserKnob {20 GamutCompress}
addUserKnob {41 threshold t "Percentage of the outer gamut boundary to affect. A value of 0.2 means 20% of the outer gamut will be utilized for gamut compression." T compress.threshold}
addUserKnob {41 power t "Adjust the exponent of the compression function. 1 = Reinhard. Higher values have C2 continuity and result in a more \"aggressive\" curve which preserves more color purity or saturation.\n\nBe wary of high values if accurate inv\nersion is important to you." T compress.power}
addUserKnob {7 shd_rolloff l "shd rolloff" t "Shadow rolloff reduces the gamut compression effect below the specified pixel value. This reduces invertability issues with negative pixels in shadow grain." R 0 0.1}
shd_rolloff 0.0165
addUserKnob {26 distance_limit_label l " " t "Specifies the maximum distance beyond the gamut boundary to map to the gamut boundary for each color component." T "<b>max distance limit"}
addUserKnob {41 cyan t "Maximum distance beyond the green-blue gamut boundary to compress to the gamut boundary." T compress.cyan}
addUserKnob {41 magenta t "Maximum distance beyond the blue-red gamut boundary to compress to the gamut boundary." T compress.magenta}
addUserKnob {41 yellow t "Maximum distance beyond the red-green gamut boundary to compress to the gamut boundary." T compress.yellow}
addUserKnob {22 reset t "Reset knobs to default values. Distance limits are calculated based on an the average of a selection of digital cinema cameras." T "n = nuke.thisNode()\nnuke.root().begin()\ndefaults = \{\n    'threshold': 0.2,\n    'power': 1.2,\n    'shd_rolloff': 0.03,\n    'cyan': 0.09,\n    'magenta':0.24,\n    'yellow': 0.12,\n\}\nfor k, v in defaults.items():\n    n\[k].setValue(v)" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {4 direction M {forward inverse}}
addUserKnob {20 info_tab l Info}
addUserKnob {26 info_label l " " T "<style> a:link \{ color: #ccc \}</style>\n<font color=#ccc>\n<b>GamutCompress</b><br>\nmaps out of gamut colors back into gamut.\n<br><br><a href=https://github.com/jedypod/gamut-compress>Documentation</a>"}
addUserKnob {26 about_label l " " T "<style> a:link \{ color: #ccc \}</style>\n<font color=#ccc><br>\n<b>About</b><br>\nWritten by <a href=https://github.com/jedypod color=red>Jed Smith</a> <br> with <a href=https://community.acescentral.com/t/rgb-saturation-gamut-mapping-approach-and-a-comp-vfx-perspective>help</a> from the <a href=https://community.acescentral.com/c/aces-development-acesnext/vwg-aces-gamut-mapping-working-group>ACES Gamut Mapping VWG</a>"}
}
Input {
inputs 0
name Input
xpos -40
ypos -274
}
Dot {
name Dot4
xpos -6
ypos -174
}
set N3e65f800 [stack 0]
Dot {
name Dot2
xpos -226
ypos -174
}
Expression {
channel0 {rgba.red rgba.green rgba.blue none}
expr0 max(r,g,b)
name achromatic
xpos -260
ypos -130
}
set N3e65f000 [stack 0]
Dot {
name Dot1
xpos -226
ypos -78
}
set N3e65ec00 [stack 0]
Dot {
name Dot3
xpos -226
ypos 114
}
push $N3e65ec00
Expression {
temp_name0 c_r
temp_expr0 1-r
temp_name1 c_g
temp_expr1 1-g
temp_name2 c_b
temp_expr2 1-b
expr0 1-(c_r<(1-thr)?c_r:(1-thr)+thr*tanh(((c_r-(1-thr))/thr)))
expr1 1-(c_g<(1-thr)?c_g:(1-thr)+thr*tanh(((c_g-(1-thr))/thr)))
expr2 1-(c_b<(1-thr)?c_b:(1-thr)+thr*tanh(((c_b-(1-thr))/thr)))
name toe
xpos -150
ypos -82
disable {{parent.shd_rolloff==0}}
addUserKnob {20 Params_tab l Params}
addUserKnob {7 thr t "complement of threshold"}
thr {{parent.shd_rolloff}}
}
set N3e65e400 [stack 0]
Dot {
name Dot7
xpos -116
ypos 66
}
push $N3e65f000
push $N3e65f800
Merge2 {
inputs 2
operation minus
bbox B
Achannels rgb
Bchannels rgb
output rgb
name Merge1
xpos -40
ypos -130
}
push $N3e65e400
Merge2 {
inputs 2
operation divide
bbox B
Achannels rgb
Bchannels rgb
output rgb
name Merge2
xpos -40
ypos -82
}
Group {
name compress
xpos -40
ypos -10
addUserKnob {20 compress}
addUserKnob {18 threshold}
threshold 0.29
addUserKnob {6 threshold_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {7 power R 1 5}
power 1.2
addUserKnob {7 cyan}
cyan 1
addUserKnob {7 magenta}
magenta 0.2
addUserKnob {7 yellow}
yellow 0.125
addUserKnob {26 ""}
addUserKnob {6 invert +STARTLINE}
invert {{parent.direction}}
}
Input {
inputs 0
name Input
xpos -260
ypos -250
}
set N3e65d400 [stack 0]
Expression {
temp_name0 s_x
temp_expr0 (lim_x-thr_x)/pow(pow((1-thr_x)/(lim_x-thr_x),-p)-1,1/p)
temp_name1 s_y
temp_expr1 (lim_y-thr_y)/pow(pow((1-thr_y)/(lim_y-thr_y),-p)-1,1/p)
temp_name2 s_z
temp_expr2 (lim_z-thr_z)/pow(pow((1-thr_z)/(lim_z-thr_z),-p)-1,1/p)
expr0 r<thr_x||lim_x<1.0001?r:r>(thr_x+s_x)?r:thr_x+s_x*pow(-(pow((r-thr_x)/s_x,p)/(pow((r-thr_x)/s_x,p)-1)),1/p)
expr1 g<thr_y||lim_y<1.0001?g:g>(thr_y+s_y)?g:thr_y+s_y*pow(-(pow((g-thr_y)/s_y,p)/(pow((g-thr_y)/s_y,p)-1)),1/p)
expr2 b<thr_z||lim_z<1.0001?b:b>(thr_z+s_z)?b:thr_z+s_z*pow(-(pow((b-thr_z)/s_z,p)/(pow((b-thr_z)/s_z,p)-1)),1/p)
name uncompress
xpos -150
ypos -202
addUserKnob {20 Params_tab l Params}
addUserKnob {7 thr_x}
thr_x {{1-parent.threshold.r}}
addUserKnob {7 thr_y}
thr_y {{1-parent.threshold.g}}
addUserKnob {7 thr_z}
thr_z {{1-parent.threshold.b}}
addUserKnob {7 lim_x}
lim_x {{parent.cyan+1}}
addUserKnob {7 lim_y}
lim_y {{parent.magenta+1}}
addUserKnob {7 lim_z}
lim_z {{parent.yellow+1}}
addUserKnob {7 p R 1 5}
p {{parent.power}}
}
push $N3e65d400
Expression {
temp_name0 s_x
temp_expr0 (lim_x-thr_x)/pow(pow((1-thr_x)/(lim_x-thr_x),-p)-1,1/p)
temp_name1 s_y
temp_expr1 (lim_y-thr_y)/pow(pow((1-thr_y)/(lim_y-thr_y),-p)-1,1/p)
temp_name2 s_z
temp_expr2 (lim_z-thr_z)/pow(pow((1-thr_z)/(lim_z-thr_z),-p)-1,1/p)
expr0 r<thr_x||lim_x<1.0001?r:thr_x+s_x*((r-thr_x)/s_x)/(pow(1+pow((r-thr_x)/s_x,p),1/p))
expr1 g<thr_y||lim_y<1.0001?g:thr_y+s_y*((g-thr_y)/s_y)/(pow(1+pow((g-thr_y)/s_y,p),1/p))
expr2 b<thr_z||lim_z<1.0001?b:thr_z+s_z*((b-thr_z)/s_z)/(pow(1+pow((b-thr_z)/s_z,p),1/p))
name compress
xpos -370
ypos -202
addUserKnob {20 Params_tab l Params}
addUserKnob {7 thr_x}
thr_x {{1-parent.threshold.r}}
addUserKnob {7 thr_y}
thr_y {{1-parent.threshold.g}}
addUserKnob {7 thr_z}
thr_z {{1-parent.threshold.b}}
addUserKnob {7 lim_x}
lim_x {{parent.cyan+1}}
addUserKnob {7 lim_y}
lim_y {{parent.magenta+1}}
addUserKnob {7 lim_z}
lim_z {{parent.yellow+1}}
addUserKnob {7 p R 1 5}
p {{parent.power}}
}
Switch {
inputs 2
which {{parent.invert}}
name switch_direction
xpos -260
ypos -154
}
Output {
name Output
xpos -260
ypos -106
}
end_group
Merge2 {
inputs 2
operation multiply
bbox B
Achannels rgb
Bchannels rgb
output rgb
name Merge3
xpos -40
ypos 62
}
Merge2 {
inputs 2
operation minus
bbox B
Achannels rgb
Bchannels rgb
output rgb
name Merge5
xpos -40
ypos 110
}
Output {
name Output
xpos -40
ypos 182
}
end_group
push $N3e6c9c00
Dot {
name Dot61
xpos -755
ypos 153
}
Blur {
size 1
name Blur6
xpos -789
ypos 417
}
Merge2 {
inputs 2
operation plus
name Merge10
xpos -789
ypos 460
}
Dot {
name Dot42
xpos -282
ypos 464
}
Dot {
name Dot46
xpos -282
ypos 277
}
push $N3fc3fc00
Dot {
name Dot67
xpos -581
ypos -19
}
Dot {
name Dot17
xpos -581
ypos 185
}
set N3e605800 [stack 0]
Dot {
name Dot43
xpos -695
ypos 185
}
set N3e605400 [stack 0]
Dot {
name Dot25
xpos -837
ypos 185
}
Dot {
name Dot35
xpos -837
ypos 333
}
set N3e604c00 [stack 0]
Dot {
name Dot21
xpos -837
ypos 361
}
set N3e604800 [stack 0]
Dot {
name Dot22
xpos -837
ypos 385
}
push $N3e604800
push $N3e604c00
push $N3e605400
Dot {
name Dot6
xpos -695
ypos 229
}
set N3e5c7c00 [stack 0]
Dot {
name Dot7
xpos -695
ypos 271
}
set N3e5c7800 [stack 0]
Dot {
name Dot8
xpos -695
ypos 311
}
set N3e5c7400 [stack 0]
push $N3e5c7400
push $N3e5c7800
push 0
push $N3e5c7c00
push 0
push $N3e6ca400
Colorspace {
colorspace_in REDLog
name Colorspace8
xpos -95
ypos -161
}
Dot {
name Dot41
xpos -61
ypos -35
}
Dot {
name Dot11
xpos -521
ypos -35
}
Dot {
name Dot2
xpos -521
ypos 229
}
set N3e5c6400 [stack 0]
Group {
inputs 3
name red
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -637
ypos 220
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity {{parent.Blur.r*0.5}}
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 3.3
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
effect_only {{parent.soft==0}}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.r}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 5
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
crop true
addUserKnob {14 overscan +DISABLED R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE +DISABLED}
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N3e5c5000 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N3e5c4c00 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N3e5c4c00
Remove {
operation keep
channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N1ba62400 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N1ba61c00 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N1ba62400
push $N1ba61c00
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N3e5c5000
Dot {
name Dot4
xpos -604
ypos 582
}
set N1bac3000 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N1bac3000
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan x1 0} {parent.crop?0:-parent.overscan x1 0} {parent.crop?width:width+parent.overscan x1 1372} {parent.crop?height:height+parent.overscan x1 900}}
intersect true
name CropOverscan
selected true
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Group {
inputs 3
name green
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -637
ypos 262
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity {{parent.Blur.g*0.5}}
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 3.2
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.g}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 5
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
crop true
addUserKnob {14 overscan +DISABLED R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE +DISABLED}
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N1bb23800 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N1bb23400 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N1bb23400
Remove {
operation keep
channels {-rgba.red rgba.green -rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N1bb21000 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N1bb20800 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N1bb21000
push $N1bb20800
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N1bb23800
Dot {
name Dot4
xpos -604
ypos 582
}
set N1bb71c00 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N1bb71c00
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Group {
inputs 3
name blue
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -637
ypos 302
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity {{parent.Blur.b*0.5}}
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 1.25
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
effect_only {{parent.soft==0}}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.Blur.b}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff 5
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
crop true
addUserKnob {14 overscan +DISABLED R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE +DISABLED}
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N1bbda400 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N1bbda000 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N1bbda000
Remove {
operation keep
channels {-rgba.red -rgba.green rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N8c997800 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N8c997000 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N8c997800
push $N8c997000
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
selected true
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N1bbda400
Dot {
name Dot4
xpos -604
ypos 582
}
set N8c994800 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N8c994800
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
set N1bb92b00 [stack 0]
Dot {
name Dot33
xpos -603
ypos 333
}
FilterErode {
inputs 1+1
channels {rgba.red -rgba.green -rgba.blue -rgba.alpha}
size {{parent.Erode.r}}
filter gaussian
name ErodeRed1
xpos -793
ypos 330
}
FilterErode {
inputs 1+1
channels {-rgba.red rgba.green -rgba.blue -rgba.alpha}
size {{parent.Erode.g}}
filter gaussian
name ErodeGreen1
xpos -793
ypos 358
}
FilterErode {
inputs 1+1
channels {-rgba.red -rgba.green rgba.blue -rgba.alpha}
size {{parent.Erode.b}}
filter gaussian
name ErodeBlue1
xpos -793
ypos 382
}
Dot {
name Dot29
xpos -759
ypos 38
}
Dot {
name Dot49
xpos -162
ypos 38
}
push $N3e5c7400
Dot {
name Dot4
xpos -695
ypos 358
}
set N8c9f0800 [stack 0]
Dot {
name Dot13
xpos -695
ypos 386
}
set N8c9f0400 [stack 0]
Dot {
name Dot16
xpos -695
ypos 410
}
push $N8c9f0400
push $N8c9f0800
push $N3e5c6400
Dot {
name Dot5
xpos -521
ypos 358
}
FilterErode {
inputs 1+1
channels {rgba.red -rgba.green -rgba.blue -rgba.alpha}
size {{parent.Erode.r}}
filter gaussian
name ErodeRed
xpos -637
ypos 355
}
FilterErode {
inputs 1+1
channels {-rgba.red rgba.green -rgba.blue -rgba.alpha}
size {{parent.Erode.g}}
filter gaussian
name ErodeGreen
xpos -637
ypos 383
}
FilterErode {
inputs 1+1
channels {-rgba.red -rgba.green rgba.blue -rgba.alpha}
size {{parent.Erode.b}}
filter gaussian
name ErodeBlue
xpos -637
ypos 407
}
Dot {
name Dot14
xpos -603
ypos 488
}
Dot {
name Dot24
xpos -338
ypos 488
}
Dot {
name Dot50
xpos -338
ypos 51
}
Dot {
name Dot26
xpos -162
ypos 51
}
push $N1bb92b00
Dot {
name Dot44
xpos -421
ypos 311
}
Dot {
name Dot48
xpos -421
ypos 25
}
Dot {
name Dot12
xpos -162
ypos 25
}
Switch {
inputs 3
name Switch1
xpos -100
ypos 22
}
Colorspace {
colorspace_out REDLog
name Colorspace7
xpos -100
ypos 79
}
push $N3e6c9c00
Merge2 {
inputs 2
operation minus
name Merge5
xpos -99
ypos 150
}
ColorCorrect {
gain {{parent.double}}
name ColorCorrect2
xpos -99
ypos 203
}
push $N3e6c9c00
Dot {
name Dot31
xpos 68
ypos 236
}
set N8ca93800 [stack 0]
Merge2 {
inputs 2
name Merge6
xpos -99
ypos 233
}
push $N3e605800
Premult {
name Premult1
xpos 176
ypos 182
}
Dot {
name Dot18
xpos 210
ypos 113
}
FilterErode {
channels {rgba.red -rgba.green -rgba.blue none}
size {{parent.Erode.r}}
filter gaussian
name FilterErode2
xpos 263
ypos 110
}
FilterErode {
channels {-rgba.red rgba.green -rgba.blue none}
size {{parent.Erode.g}}
filter gaussian
name FilterErode3
xpos 263
ypos 139
}
FilterErode {
channels {-rgba.red -rgba.green rgba.blue none}
size {{parent.Erode.b}}
filter gaussian
name FilterErode4
xpos 263
ypos 163
}
Blur {
channels {rgba.red -rgba.green -rgba.blue none}
size {{parent.Blur.r}}
mix 0.285
name Blur2
xpos 263
ypos 187
}
Blur {
channels {-rgba.red rgba.green -rgba.blue none}
size {{parent.Blur.g}}
name Blur3
xpos 263
ypos 215
}
Blur {
channels {-rgba.red -rgba.green rgba.blue none}
size {{parent.Blur.b}}
name Blur4
xpos 263
ypos 245
}
push $N3e6ca000
Dot {
name Dot32
xpos 297
ypos -277
}
Dot {
name Dot15
xpos 297
ypos 4
}
set N8ca90c00 [stack 0]
Dot {
name Dot19
xpos 431
ypos 4
}
Colorspace {
colorspace_in Panalog
name Colorspace3
xpos 397
ypos 93
}
Merge2 {
inputs 2
mix 0.25
name Merge3
xpos 397
ypos 245
}
Colorspace {
colorspace_out Panalog
name Colorspace4
xpos 397
ypos 274
}
Switch {
inputs 3
which 2
name Switch2
xpos -100
ypos 274
}
push $N8ca93800
Dot {
name Dot30
xpos 68
ypos 331
}
set N8caf3000 [stack 0]
Merge2 {
inputs 2
operation minus
maskChannelInput -rgba.alpha
invert_mask true
name Merge2
xpos -100
ypos 328
}
Group {
name apGlow
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -230
ypos 322
disable {{parent.glow==0}}
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity {{parent.glow_intensity.r}}
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 1
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.glow_radius.r}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff {{parent.glow_falloff.r}}
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
crop true
addUserKnob {14 overscan +DISABLED R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE +DISABLED}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N8caf1800 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N8caf1400 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N8caf1400
Remove {
operation keep
channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N8cb4ac00 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N8cb4a400 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N8cb4ac00
push $N8cb4a400
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N8caf1800
Dot {
name Dot4
xpos -604
ypos 582
}
set N8cbef800 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N8cbef800
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Group {
name apGlow1
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -230
ypos 410
disable {{parent.glow==0}}
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity {{parent.glow_intensity.g}}
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 1
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.glow_radius.g}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff {{parent.glow_falloff.g}}
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
crop true
addUserKnob {14 overscan +DISABLED R 0 1000}
overscan 100
addUserKnob {6 enableOverscan l enable -STARTLINE +DISABLED}
enableOverscan true
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N8cbec400 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N8cc43c00 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N8cc43c00
Remove {
operation keep
channels {-rgba.red rgba.green -rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N8cc41800 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N8cc41000 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N8cc41800
push $N8cc41000
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N8cbec400
Dot {
name Dot4
xpos -604
ypos 582
}
set N8cc9e400 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N8cc9e400
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
Group {
name apGlow2
help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
tile_color 0xe88543ff
xpos -98
ypos 410
disable {{parent.glow==0}}
addUserKnob {20 apGlow}
addUserKnob {41 channels T KeepWhat.channels}
addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
intensity {{parent.glow_intensity.b}}
addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
persistance 1
addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {18 tint t "Overall color multiplier for the intensity."}
tint 1
addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
addUserKnob {6 effect_only l "effect only" +STARTLINE}
addUserKnob {26 ""}
addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
src_white 1
addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
response 1
addUserKnob {26 ""}
addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
max_size {{parent.glow_radius.b}}
addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
falloff {{parent.glow_falloff.b}}
addUserKnob {3 steps t "Number of blur iterations to combine together."}
steps 10
addUserKnob {41 filter T Blur.filter}
addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
addUserKnob {6 crop l "crop to format" -STARTLINE}
crop true
addUserKnob {6 enableOverscan l enable +DISABLED +STARTLINE}
enableOverscan true
addUserKnob {14 overscan +DISABLED R 0 1000}
overscan 100
addUserKnob {26 ""}
addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
addUserKnob {41 inject -STARTLINE T Merge.inject}
addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
addUserKnob {41 fringe -STARTLINE T Merge.fringe}
addUserKnob {41 mix T Merge.mix}
addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
}
Input {
inputs 0
name Inputmask
xpos -748
ypos 847
number 2
}
Input {
inputs 0
name Inputarea
xpos -156
ypos 383
number 1
}
Input {
inputs 0
name Inputimg
xpos -638
ypos 220
}
NoTimeBlur {
rounding none
name NTB
xpos -638
ypos 267
}
Dot {
name Dot6
xpos -604
ypos 308
}
set N8cd02c00 [stack 0]
Dot {
name Dot7
xpos -384
ypos 308
}
set N8cd02800 [stack 0]
Dot {
name Dot8
xpos -232
ypos 308
}
Remove {
name RemoveAll
xpos -266
ypos 345
}
Expression {
inputs 1+1
channel0 rgba
expr0 1
name ExpressionArea
xpos -266
ypos 383
disable {{"!\[exists parent.input1]"}}
}
Shuffle {
red white
green white
blue white
alpha white
name ShuffleWhite
xpos -266
ypos 409
disable {{"\[exists parent.input1]"}}
}
push $N8cd02800
Remove {
operation keep
channels {-rgba.red -rgba.green rgba.blue rgba.alpha}
name KeepWhat
xpos -418
ypos 377
}
Copy {
inputs 2
from0 rgba.alpha
to0 apGlowArea.red
name Copy1
xpos -418
ypos 403
disable {{"!\[exists parent.input1]"}}
}
Premult {
channels all
alpha apGlowArea.red
name Premult1
xpos -418
ypos 441
disable {{"!\[exists parent.input1]"}}
}
Remove {
channels apGlowArea
name RemoveArea
xpos -418
ypos 479
disable {{"!\[exists parent.input1]"}}
}
Dot {
name Dot5
xpos -384
ypos 532
}
set N8cd00400 [stack 0]
Dot {
name Dot1
xpos -284
ypos 532
}
Saturation {
channels all
saturation 0
name Saturation1
xpos -318
ypos 572
}
set N8cd4b800 [stack 0]
Grade {
channels all
blackpoint {{parent.src_black}}
whitepoint {{parent.src_white}}
gamma {{parent.response}}
name Grade1
xpos -318
ypos 610
}
push $N8cd00400
push $N8cd4b800
Merge2 {
inputs 2
operation divide
also_merge all
name Merge4
xpos -418
ypos 578
}
Merge2 {
inputs 2
operation multiply
also_merge all
name Merge3
xpos -418
ypos 616
}
Dot {
name DP
xpos -384
ypos 642
addUserKnob {20 User}
addUserKnob {14 j R 0 100}
j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
}
Blur {
size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
crop false
name Blur
xpos -418
ypos 660
}
Multiply {
value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
name Multiply
xpos -418
ypos 699
}
TimeBlur {
divisions {{parent.steps}}
shutter 1
shutteroffset start
shuttercustomoffset 0
name TB
xpos -418
ypos 736
}
Multiply {
value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
name MultiplyR
xpos -418
ypos 762
}
Expression {
expr0 isnan(r)?0:r
expr1 isnan(g)?0:g
expr2 isnan(b)?0:b
expr3 isnan(a)?0:a
name NanToBlack
xpos -418
ypos 800
}
push $N8cd02c00
Dot {
name Dot4
xpos -604
ypos 582
}
set N8cd49000 [stack 0]
Dot {
name Dot2
xpos -494
ypos 582
}
Shuffle {
red black
green black
blue black
name Shuffle
xpos -528
ypos 660
disable {{!parent.effect_only}}
}
Remove {
operation keep
channels rgb
name Remove1
xpos -528
ypos 686
disable {{!parent.effect_only}}
}
Merge2 {
inputs 2
operation plus
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge1
xpos -528
ypos 800
}
Dot {
name Dot3
xpos -494
ypos 850
}
push $N8cd49000
Merge2 {
inputs 2+1
operation copy
output {rgba.red rgba.green rgba.blue -rgba.alpha}
also_merge all
name Merge
xpos -638
ypos 846
}
Crop {
box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
intersect true
name CropOverscan
xpos -638
ypos 872
disable {{"!parent.enableOverscan && !parent.crop"}}
}
Output {
name Output
xpos -638
ypos 898
}
end_group
OFXuk.co.thefoundry.furnace.f_regrain_v403 {
inputs 2
grainType "Preset Stock"
presetStock "FUJIF250Under 2K"
amount 2
size 1
output Result
"Analysis Region" 0
regionBL {921.5999756 700.1999815}
regionTR {1126.400024 855.8000185}
frame 1
grainColourSpace sRGB
Advanced 0
processRed true
redAmount 1
redSize 1
processGreen true
greenAmount 1
greenSize 1
processBlue true
blueAmount 1
blueSize 1
"Grain Response" 0
srcColourSpace "Grain Colour Space"
lowGain 0
midGain 1.5
highGain 1
useResponse false
responseMix 1
drawResponse false
needsGrainSample true
notBeenAnalysed true
grainClipNeeded true
inputHasChanged false
responseR0Counts 0
responseR0Samples 0
responseG0Counts 0
responseG0Samples 0
responseB0Counts 0
responseB0Samples 0
responseR1Counts 0
responseR1Samples 0
responseG1Counts 0
responseG1Samples 0
responseB1Counts 0
responseB1Samples 0
responseR2Counts 0
responseR2Samples 0
responseG2Counts 0
responseG2Samples 0
responseB2Counts 0
responseB2Samples 0
responseR3Counts 0
responseR3Samples 0
responseG3Counts 0
responseG3Samples 0
responseB3Counts 0
responseB3Samples 0
responseR4Counts 0
responseR4Samples 0
responseG4Counts 0
responseG4Samples 0
responseB4Counts 0
responseB4Samples 0
responseR5Counts 0
responseR5Samples 0
responseG5Counts 0
responseG5Samples 0
responseB5Counts 0
responseB5Samples 0
responseR6Counts 0
responseR6Samples 0
responseG6Counts 0
responseG6Samples 0
responseB6Counts 0
responseB6Samples 0
responseR7Counts 0
responseR7Samples 0
responseG7Counts 0
responseG7Samples 0
responseB7Counts 0
responseB7Samples 0
responseR8Counts 0
responseR8Samples 0
responseG8Counts 0
responseG8Samples 0
responseB8Counts 0
responseB8Samples 0
responseR9Counts 0
responseR9Samples 0
responseG9Counts 0
responseG9Samples 0
responseB9Counts 0
responseB9Samples 0
grainSample ""
cacheBreaker true
name F_ReGrain1
xpos -98
ypos 476
disable {{parent.grain==0}}
}
push $N8caf3000
Dot {
name Dot36
xpos 68
ypos 521
}
Merge2 {
inputs 2
operation plus
name Merge4
xpos -98
ypos 518
}
Switch {
inputs 2
which {{parent.alpha}}
name Switch3
xpos -98
ypos 643
}
push $N8ca90c00
Dot {
name Dot10
xpos 127
ypos 4
}
Dot {
name Dot27
xpos 127
ypos 704
}
Merge2 {
inputs 2+1
operation copy
name Merge1
xpos -98
ypos 701
}
Shuffle {
red alpha
green alpha
blue alpha
name Shuffle13
xpos -97
ypos 758
disable {{parent.alpha==0}}
}
Output {
name Output1
xpos -97
ypos 815
}
StickyNote {
inputs 0
name StickyNote3
label 3
note_font_size 20
xpos -1796
ypos 481
}
StickyNote {
inputs 0
name StickyNote1
label 1
note_font_size 20
xpos -1526
ypos 470
}
StickyNote {
inputs 0
name StickyNote2
label 2
note_font_size 20
xpos -1288
ypos 455
}
NoOp {
inputs 0
name NoOp1
xpos -1361
ypos 763
addUserKnob {20 User}
addUserKnob {7 R_value}
R_value {{Blur.r}}
addUserKnob {7 GB_value}
GB_value {{(Blur.g+Blur.b)/2}}
}
end_group
